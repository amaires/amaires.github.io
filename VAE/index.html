<!DOCTYPE html> 
<html lang="en" xml:lang="en" > 
<head><title>Variational Autoencoders</title> 
<meta  charset="utf-8" /> 
<meta name="generator" content="TeX4ht (https://tug.org/tex4ht/)" /> 
<meta name="viewport" content="width=device-width,initial-scale=1" /> 
<link rel="stylesheet" type="text/css" href="VAE.css" /> 
<meta name="src" content="VAE.tex" /> 
</head><body 
>
   <div class="maketitle">


<h2 class="titleHead">Variational Autoencoders</h2>
<div class="author" ></div><br />
<div class="date" ><span 
class="ecrm-1200">Amaires@May 2024 </span></div>
   </div>A Variational AutoEncoder (VAE) is an approach to generative modeling. In addition to its capability to generate new samples within the same
population as existing ones, it provides a probabilistic way of describing samples in a latent space.
   <h3 class="sectionHead"><span class="titlemark">1   </span> <a 
 id="x1-10001"></a>K-L Divergence</h3>
<!--l. 24--><p class="noindent" >Generative modeling relies heavily on metrics of similarities between two distributions, among which the most commonly used is called the
K-L divergence, short for Kullback–Leibler divergence. It is deﬁned below for two distributions with probability density functions
<!--l. 27--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math> and
<!--l. 28--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>:
</p>
   <table class="equation"><tr><td> <a 
 id="x1-1001r1"></a>
<!--l. 30--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                         <mstyle mathvariant="normal"><mi 
>K</mi><mi 
>L</mi></mstyle><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo><mo  
> ∫
 <!--nolimits--></mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--> <mfrac><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow> 
<mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></mfrac><mi 
>d</mi><mi 
>x</mi>
</math></td><td class="eq-no">(1)</td></tr></table>
<!--l. 34--><p class="indent" >   K-L divergence has two important properties.
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-1003x1">It is obvious that K-L divergence is not symmetric in terms of <!--l. 36--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>
     and <!--l. 37--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>.
     </li>
     <li 
  class="enumerate" id="x1-1005x2">It is always non-negative, and it is 0 iﬀ <!--l. 38--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>
     and <!--l. 38--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>
     are the same everywhere. To see why, we can break DL-divergence into two parts:</li></ol>
<!--l. 42--><p class="noindent" >

</p><!--tex4ht:inline--><!--l. 46--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mtable 
columnalign="left" class="align">
                              <mtr><mtd 
columnalign="right" class="align-odd"><mstyle mathvariant="normal"><mi 
>K</mi><mi 
>L</mi></mstyle><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo></mtd>                              <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo><mo  
> ∫
 <!--nolimits--></mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--> <mfrac><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow> 
<mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></mfrac><mi 
>d</mi><mi 
>x</mi><mspace width="2em"/></mtd>                                                    <mtd 
columnalign="right" class="align-label"></mtd>                              <mtd 
class="align-label">
                              <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>                                            <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo><mo  
> ∫
 <!--nolimits--></mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mstyle mathvariant="normal"><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--></mstyle><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mi 
>d</mi><mi 
>x</mi> <mo 
class="MathClass-bin">−</mo><mo  
>∫
 <!--nolimits--></mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mstyle mathvariant="normal"><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--></mstyle><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mi 
>d</mi><mi 
>x</mi><mspace width="2em"/></mtd>                                   <mtd 
columnalign="right" class="align-label"></mtd>                              <mtd 
class="align-label">
                              <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>                                            <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-bin">−</mo><mo  
>∫
 <!--nolimits--></mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mstyle mathvariant="normal"><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--></mstyle><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mi 
>d</mi><mi 
>x</mi> <mo 
class="MathClass-bin">−</mo> <mo 
class="MathClass-open">(</mo><mo 
class="MathClass-bin">−</mo><mo  
>∫
 <!--nolimits--></mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mstyle mathvariant="normal"><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--></mstyle><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mi 
>d</mi><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mspace width="2em"/></mtd>                                                            <mtd 
columnalign="right" class="align-label"><mstyle 
   id="x1-1006r2"  class="label" ></mstyle><!--endlabel--><mstyle 
class="maketag"><mtext  >(2)</mtext></mstyle><mspace width="0.33em" class="nbsp" />
   </mtd></mtr></mtable></math>
<!--l. 48--><p class="indent" >   The second term in (<a 
href="#x1-1006r2">2<!--tex4ht:ref: eq:dl-diverg --></a>), with the negative sign, is <!--l. 49--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></math>’s
information theoretic entropy. The ﬁrst term, also with the negative sign, is the cross entropy between
<!--l. 50--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></math> and
<!--l. 51--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></math>. The ﬁrst
term is always no smaller than the second term per Gibb’s inequality.
</p><!--l. 54--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">2   </span> <a 
 id="x1-20002"></a>Intuition</h3>
<!--l. 56--><p class="noindent" >The concept of autoencoders predate the VAE. An autoencoder, shown in Figure <a 
href="#x1-20011">1<!--tex4ht:ref: fig:Autoencoder --></a>, consists of an encoder
<!--l. 57--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
></math> and a
decoder <!--l. 58--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
></math>.
<!--l. 58--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
></math>, a deep neural network
parameterized by <!--l. 59--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>ϕ</mi></math>,
takes a sample <!--l. 59--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>
from population <!--l. 59--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>𝕏</mi></math>
and maps it to <!--l. 60--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>z</mi> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>
in <!--l. 60--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>ℤ</mi></math>.
<!--l. 60--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
></math>, another deep neural
network parameterized by <!--l. 61--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>𝜃</mi></math>,
aiming to reconstruct <!--l. 62--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>,
takes <!--l. 62--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>z</mi></math> as input
and maps it to <!--l. 62--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>x</mi></mrow><mo accent="true">~</mo></mover> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo></math>.
<!--l. 63--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>ℤ</mi></math> is usually of a lower
dimension than <!--l. 63--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>𝕏</mi></math>
, and thus <!--l. 64--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
></math>
is considerd to posess some compression capability and unsupervised feature extraction capability.
</p>
   <figure class="figure"> 

<a 
 id="x1-20011"></a>
<!--l. 69--><p class="noindent" ><img 
src="pic_00.svg" alt="PIC"  
 /><br />
</p>
<figcaption class="caption" ><span class="id">Figure 1:</span><span  
class="content">Autoencoder</span></figcaption><!--tex4ht:label?: x1-20011 -->
   </figure>
<!--l. 74--><p class="indent" >   The training of an autoencoder minimizes the reconstruction loss: the expected
<!--l. 75--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>L</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></math> distance
between <!--l. 75--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>
and <!--l. 75--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>x</mi></mrow><mo accent="true">~</mo></mover></math>:
</p>
   <table class="equation-star"><tr><td>
<!--l. 77--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                 <munder class="msub"><mrow 
><mi class="qopname">min</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
><mi 
>𝜃</mi><mo 
class="MathClass-punc">,</mo><mi 
>ϕ</mi></mrow></munder 
> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mi 
>n</mi></mrow></mfrac><munder class="msub"><mrow 
><mo  
>∑</mo>
   </mrow><mrow 
><mi 
>i</mi></mrow></munder 
><msup><mrow 
> <mrow><mo fence="true" form="prefix"> ∥</mo><mrow><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">−</mo><msub><mrow 
><mover 
accent="true"><mrow 
><mi 
>x</mi></mrow><mo accent="true">~</mo></mover></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow><mo fence="true" form="postfix">∥</mo></mrow> </mrow><mrow 
><mn>2</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <mstyle mathvariant="normal"><munder class="msub"><mrow 
><mi class="qopname">min</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
>
<mi 
>𝜃</mi><mo 
class="MathClass-punc">,</mo><mi 
>ϕ</mi></mrow></munder 
></mstyle> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mi 
>n</mi></mrow></mfrac><munder class="msub"><mrow 
><mo  
>∑</mo>
   </mrow><mrow 
><mi 
>i</mi></mrow></munder 
><msup><mrow 
> <mrow><mo fence="true" form="prefix"> ∥</mo><mrow><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo></mrow><mo fence="true" form="postfix">∥</mo></mrow></mrow><mrow 
><mn>2</mn></mrow></msup 
>
</math></td></tr></table>
<!--l. 81--><p class="indent" >   Once trained, the decoder <!--l. 81--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
></math>,
to some extent, is already a generative model in that it can create samples in
<!--l. 82--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>𝕏</mi></math> given a sample
<!--l. 83--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>z</mi></math>. The distribution of
<!--l. 83--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>z</mi></math> or even the range of
<!--l. 84--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>z</mi></math>, however, is unknown, which prevents its
eﬀective sampling. Ideally, we’d like <!--l. 85--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>z</mi></math> to
follow some simple distribution, such as <!--l. 86--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>N</mi><mo 
class="MathClass-open">(</mo><mn>0</mn><mo 
class="MathClass-punc">,</mo><mi 
>I</mi><mo 
class="MathClass-close">)</mo></math>,
as it is easy to sample from. As summarized in Figure <a 
href="#x1-20022">2<!--tex4ht:ref: fig:Variational-autoencoder --></a>, VAE makes a few changes to the autoencoder architecture to make
<!--l. 87--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
></math> able to take samples
from <!--l. 88--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>N</mi><mo 
class="MathClass-open">(</mo><mn>0</mn><mo 
class="MathClass-punc">,</mo><mi 
>I</mi><mo 
class="MathClass-close">)</mo></math> as input and
map them to <!--l. 88--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>𝕏</mi></math>.
</p>
     <ul class="itemize1">
     <li class="itemize">Instead of giving out concrete samples in <!--l. 90--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>ℤ</mi></math>,
     <!--l. 90--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
></math>
     outputs the parameters for the probability density function <!--l. 91--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>.
     </li>
     <li class="itemize"><!--l. 92--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>
     is required to be a multivariant normal distribution with independent components. That is, <!--l. 93--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo> <mi 
>N</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-punc">,</mo><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo></math>
     where <!--l. 94--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>
     is a diagonal matrix.
     </li>
     <li class="itemize"><!--l. 95--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>
     is penalized for being diﬀerent from <!--l. 95--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>0</mn></math>,
     and <!--l. 95--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>
     for being diﬀerent from <!--l. 96--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>I</mi></math>.
     With this penalty, <!--l. 97--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>
     approximately follows <!--l. 97--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>N</mi><mo 
class="MathClass-open">(</mo><mn>0</mn><mo 
class="MathClass-punc">,</mo><mi 
>I</mi><mo 
class="MathClass-close">)</mo></math>,
     so does <!--l. 97--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></math>
     as <!--l. 98--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo><mi 
class="MathClass-op"> ∫
 <!--nolimits--></mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo><!--nolimits--><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mi 
>d</mi><mi 
>x</mi> <mo 
class="MathClass-rel">=</mo><mi 
class="MathClass-op"> ∫
 <!--nolimits--></mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo><!--nolimits--><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mi 
>N</mi><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-punc">;</mo><mn>0</mn><mo 
class="MathClass-punc">,</mo><mi 
>I</mi><mo 
class="MathClass-close">)</mo><mi 
>d</mi><mi 
>x</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>N</mi><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-punc">;</mo><mn>0</mn><mo 
class="MathClass-punc">,</mo><mi 
>I</mi><mo 
class="MathClass-close">)</mo></math>.
     </li>
     <li class="itemize">A new sampler component <!--l. 99--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>S</mi></math>
     is introduced which, given <!--l. 99--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>
     and <!--l. 100--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>,
     draws a sample <!--l. 100--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>z</mi> <mo 
class="MathClass-rel">∼</mo> <mi 
>N</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-punc">,</mo><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo></math>.
     <!--l. 101--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>z</mi></math>
     is then fed to the decoder <!--l. 101--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
></math>,
     just as in a regular autoencoder.</li></ul>
<figure class="figure"> 
<a 
 id="x1-20022"></a> <img 
src="pic_01.svg" alt="PIC"  
 /><br />
<figcaption class="caption" ><span class="id">Figure 2:</span><span  
class="content">Variational autoencoder</span></figcaption><!--tex4ht:label?: x1-20022 -->
   </figure>
<!--l. 111--><p class="indent" >   How exactly are <!--l. 111--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math> and
<!--l. 111--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math> penalized? Compute the
K-L divergence between <!--l. 112--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>N</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-punc">,</mo><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo></math>
and <!--l. 113--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>N</mi><mo 
class="MathClass-open">(</mo><mn>0</mn><mo 
class="MathClass-punc">,</mo><mi 
>I</mi><mo 
class="MathClass-close">)</mo></math> as
below:
</p><!--l. 115--><p class="indent" >
</p><!--tex4ht:inline--><!--l. 118--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mtable 
columnalign="left" class="align">
                                 <mtr><mtd 
columnalign="right" class="align-odd"><mstyle mathvariant="normal"><mi 
>K</mi><mi 
>L</mi></mstyle><mo 
class="MathClass-open">(</mo><mi 
>N</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>u</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-punc">,</mo><mi 
>N</mi><mo 
class="MathClass-open">(</mo><mn>0</mn><mo 
class="MathClass-punc">,</mo><mi 
>I</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo></mtd>                                 <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo><mo  
> ∫
 <!--nolimits--></mo><!--nolimits--><mi 
>N</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>u</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
><mo 
class="MathClass-close">)</mo><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--> <mfrac><mrow 
><mi 
>N</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>u</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
><mo 
class="MathClass-close">)</mo></mrow> 
   <mrow 
><mi 
>N</mi><mo 
class="MathClass-open">(</mo><mn>0</mn><mo 
class="MathClass-punc">,</mo><mi 
>I</mi><mo 
class="MathClass-close">)</mo></mrow></mfrac>   <mspace width="2em"/></mtd>                                           <mtd 
columnalign="right" class="align-label"></mtd>                                 <mtd 
class="align-label">
                                 <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>                                                     <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>2</mn></mrow></mfrac><munderover accentunder="false" accent="false"><mrow  
><mo  
>∑</mo>
  </mrow><mrow 
><mi 
>k</mi><mo 
class="MathClass-rel">=</mo><mn>1</mn></mrow><mrow 
><mi 
>d</mi></mrow></munderover 
><mo 
class="MathClass-open">(</mo><msubsup><mrow 
><mi 
>μ</mi></mrow><mrow 
>
<mi 
>ϕ</mi><mo 
class="MathClass-punc">,</mo><mi 
>k</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
> <mo 
class="MathClass-bin">+</mo> <msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
>
<mi 
>ϕ</mi><mo 
class="MathClass-punc">,</mo><mi 
>k</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
> <mo 
class="MathClass-bin">−</mo><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
>
<mi 
>ϕ</mi><mo 
class="MathClass-punc">,</mo><mi 
>k</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
> <mo 
class="MathClass-bin">−</mo> <mn>1</mn><mo 
class="MathClass-close">)</mo><mspace width="2em"/></mtd>                                                                  <mtd 
columnalign="right" class="align-label"><mstyle 
   id="x1-2003r3"  class="label" ></mstyle><!--endlabel--><mstyle 
class="maketag"><mtext  >(3)</mtext></mstyle><mspace width="0.33em" class="nbsp" />
   </mtd></mtr></mtable></math>
<!--l. 120--><p class="indent" >   In (<a 
href="#x1-2003r3">3<!--tex4ht:ref: eq:pre-kl-loss --></a>), <!--l. 120--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>d</mi></math> is the
dimension of <!--l. 120--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>ℤ</mi></math>.
Removing the constants from (<a 
href="#x1-2003r3">3<!--tex4ht:ref: eq:pre-kl-loss --></a>) and estimating it with samples, our ﬁnal <span 
class="ecbx-1000">K-L divergence loss </span>is
</p>
   <table class="equation"><tr><td> <a 
 id="x1-2004r4"></a>
<!--l. 124--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                 <munder class="msub"><mrow 
><mi class="qopname">min</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
><mi 
>ϕ</mi></mrow></munder 
> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mi 
>n</mi></mrow></mfrac><munder class="msub"><mrow 
><mo  
>∑</mo>
   </mrow><mrow 
><mi 
>i</mi></mrow></munder 
><munderover accentunder="false" accent="false"><mrow  
><mo  
> ∑</mo>
  </mrow><mrow 
><mi 
>k</mi><mo 
class="MathClass-rel">=</mo><mn>1</mn></mrow><mrow 
><mi 
>d</mi></mrow></munderover 
><mo 
class="MathClass-open">(</mo><msubsup><mrow 
><mi 
>μ</mi></mrow><mrow 
>
<mi 
>ϕ</mi><mo 
class="MathClass-punc">,</mo><mi 
>k</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
>
<mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>ϕ</mi><mo 
class="MathClass-punc">,</mo><mi 
>k</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
>
<mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">−</mo><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>ϕ</mi><mo 
class="MathClass-punc">,</mo><mi 
>k</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
>
<mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo>
</math></td><td class="eq-no">(4)</td></tr></table>
<!--l. 128--><p class="indent" >   The reconstruction loss for VAE, is also slightly diﬀerent from that for a regular autoencoder. It can be estimated by the following equation, given a function
<!--l. 130--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>S</mi><mo 
class="MathClass-open">(</mo><mi 
>μ</mi><mo 
class="MathClass-punc">,</mo><msup><mrow 
><mi 
>σ</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
><mo 
class="MathClass-close">)</mo></math> that returns a
sample from <!--l. 130--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>N</mi><mo 
class="MathClass-open">(</mo><mi 
>μ</mi><mo 
class="MathClass-punc">,</mo><msup><mrow 
><mi 
>σ</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
><mo 
class="MathClass-close">)</mo></math>.
</p>
   <table class="equation-star"><tr><td>
<!--l. 132--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                            <munder class="msub"><mrow 
><mi class="qopname">min</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
><mi 
>𝜃</mi><mo 
class="MathClass-punc">,</mo><mi 
>ϕ</mi></mrow></munder 
> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mi 
>n</mi></mrow></mfrac><munder class="msub"><mrow 
><mo  
>∑</mo>
   </mrow><mrow 
><mi 
>i</mi></mrow></munder 
><msup><mrow 
> <mrow><mo fence="true" form="prefix"> ∥</mo><mrow><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">−</mo><msub><mrow 
><mover 
accent="true"><mrow 
><mi 
>x</mi></mrow><mo accent="true">~</mo></mover></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow><mo fence="true" form="postfix">∥</mo></mrow> </mrow><mrow 
><mn>2</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <mstyle mathvariant="normal"><munder class="msub"><mrow 
><mi class="qopname">min</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
>
<mi 
>𝜃</mi><mo 
class="MathClass-punc">,</mo><mi 
>ϕ</mi></mrow></munder 
></mstyle> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mi 
>n</mi></mrow></mfrac><munder class="msub"><mrow 
><mo  
>∑</mo>
   </mrow><mrow 
><mi 
>i</mi></mrow></munder 
><msup><mrow 
> <mrow><mo fence="true" form="prefix"> ∥</mo><mrow><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>S</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-punc">,</mo><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
>
<mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo></mrow><mo fence="true" form="postfix">∥</mo></mrow></mrow><mrow 
><mn>2</mn></mrow></msup 
>
</math></td></tr></table>
<!--l. 136--><p class="indent" >   This formulation has one big problem. <!--l. 136--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>S</mi><mo 
class="MathClass-open">(</mo><mo 
class="MathClass-bin">⋅</mo><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-bin">⋅</mo><mo 
class="MathClass-close">)</mo></math>
is not diﬀerentiable, which makes the reconstruction loss not amenable to back-propagation based optimization. Luckily, it is easy to rewrite
<!--l. 138--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>S</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-punc">,</mo><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo></math> as
<!--l. 139--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <mi 
>S</mi><mo 
class="MathClass-open">(</mo><mn>0</mn><mo 
class="MathClass-punc">,</mo><mi 
>I</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">⊙</mo> <msub><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo></math>, where
<!--l. 139--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-bin">⊙</mo></math> is the element-wise
product and <!--l. 140--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo></math> is
<!--l. 140--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo></math>’s diagonals
arranged in a vector form, by leveraging the reparameterization trick for normal distributions. The ﬁnal formulation for the <span 
class="ecbx-1000">reconstruction loss</span>
therefore is
</p>
   <table class="equation"><tr><td> <a 
 id="x1-2005r5"></a>
<!--l. 145--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                         <munder class="msub"><mrow 
><mi class="qopname">min</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
><mi 
>𝜃</mi><mo 
class="MathClass-punc">,</mo><mi 
>ϕ</mi></mrow></munder 
> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mi 
>n</mi></mrow></mfrac><munder class="msub"><mrow 
><mo  
>∑</mo>
   </mrow><mrow 
><mi 
>i</mi></mrow></munder 
><msup><mrow 
> <mrow><mo fence="true" form="prefix"> ∥</mo><mrow><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">−</mo><msub><mrow 
><mover 
accent="true"><mrow 
><mi 
>x</mi></mrow><mo accent="true">~</mo></mover></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow><mo fence="true" form="postfix">∥</mo></mrow> </mrow><mrow 
><mn>2</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <mstyle mathvariant="normal"><munder class="msub"><mrow 
><mi class="qopname">min</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
>
<mi 
>𝜃</mi><mo 
class="MathClass-punc">,</mo><mi 
>ϕ</mi></mrow></munder 
></mstyle> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mi 
>n</mi></mrow></mfrac><munder class="msub"><mrow 
><mo  
>∑</mo>
   </mrow><mrow 
><mi 
>i</mi></mrow></munder 
><msup><mrow 
> <mrow><mo fence="true" form="prefix"> ∥</mo><mrow><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <mi 
>S</mi><mo 
class="MathClass-open">(</mo><mn>0</mn><mo 
class="MathClass-punc">,</mo><mi 
>I</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">⊙</mo> <msub><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo></mrow><mo fence="true" form="postfix">∥</mo></mrow></mrow><mrow 
><mn>2</mn></mrow></msup 
>
</math></td><td class="eq-no">(5)</td></tr></table>
<!--l. 149--><p class="indent" >   The <span 
class="ecbx-1000">total loss </span>combines the K-L divergence loss in (<a 
href="#x1-2004r4">4<!--tex4ht:ref: eq:diverg-loss --></a>) and the reconstruction loss in (<a 
href="#x1-2005r5">5<!--tex4ht:ref: eq:final_vae_recons_loss --></a>) with a weight hyperparameter
<!--l. 151--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>λ</mi></math>:
</p>
   <table class="equation"><tr><td> <a 
 id="x1-2006r6"></a>
<!--l. 153--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
           <mstyle mathvariant="normal"><munder class="msub"><mrow 
><mi class="qopname">min</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
><mi 
>𝜃</mi><mo 
class="MathClass-punc">,</mo><mi 
>ϕ</mi></mrow></munder 
></mstyle><mo 
class="MathClass-open">(</mo> <mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mi 
>n</mi></mrow></mfrac><munder class="msub"><mrow 
><mo  
>∑</mo>
   </mrow><mrow 
><mi 
>i</mi></mrow></munder 
><msup><mrow 
> <mrow><mo fence="true" form="prefix"> ∥</mo><mrow><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <mi 
>S</mi><mo 
class="MathClass-open">(</mo><mn>0</mn><mo 
class="MathClass-punc">,</mo><mi 
>I</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">⊙</mo> <msub><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo></mrow><mo fence="true" form="postfix">∥</mo></mrow></mrow><mrow 
><mn>2</mn></mrow></msup 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <mi 
>λ</mi><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mi 
>n</mi></mrow></mfrac><munder class="msub"><mrow 
><mo  
>∑</mo>
   </mrow><mrow 
><mi 
>i</mi></mrow></munder 
><munderover accentunder="false" accent="false"><mrow  
><mo  
> ∑</mo>
  </mrow><mrow 
><mi 
>k</mi><mo 
class="MathClass-rel">=</mo><mn>1</mn></mrow><mrow 
><mi 
>d</mi></mrow></munderover 
><mo 
class="MathClass-open">(</mo><msubsup><mrow 
><mi 
>μ</mi></mrow><mrow 
>
<mi 
>ϕ</mi><mo 
class="MathClass-punc">,</mo><mi 
>k</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
>
<mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>ϕ</mi><mo 
class="MathClass-punc">,</mo><mi 
>k</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
>
<mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">−</mo><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>ϕ</mi><mo 
class="MathClass-punc">,</mo><mi 
>k</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
>
<mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo>
</math></td><td class="eq-no">(6)</td></tr></table>
<!--l. 157--><p class="indent" >   <!--l. 157--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>λ</mi></math>
controls the relative importance between reconstructing the original samples and making sure
<!--l. 158--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>z</mi></math> follows
<!--l. 158--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>N</mi><mo 
class="MathClass-open">(</mo><mn>0</mn><mo 
class="MathClass-punc">,</mo><mi 
>I</mi><mo 
class="MathClass-close">)</mo></math>. It is likely that diﬀerent
data sets require diﬀerent <!--l. 159--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>λ</mi></math>.
</p><!--l. 161--><p class="indent" >   In practice, instead of outputting <!--l. 161--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo></math>,
<!--l. 161--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
></math> outputs
<!--l. 162--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo></math>, but that
is only a minor engineering detail.
</p>
   <h3 class="sectionHead"><span class="titlemark">3   </span> <a 
 id="x1-30003"></a>Bayesian View</h3>
<!--l. 167--><p class="noindent" >This section derives the total loss objective function through a Bayesian view.
</p><!--l. 170--><p class="indent" >   The maximum likelihood method is often used to optimize a neural network that takes samples
<!--l. 171--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></math> as input and produces
<!--l. 171--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo></math>. Assuming each of these
<!--l. 172--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></math> are i.i.d samples, the likelihood
of observing all of them is <!--l. 173--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>3</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-rel">⋯</mo><mspace width="0.17em" class="thinspace"/><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo><mi 
class="MathClass-op"> ∏</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo>
  <!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo></math>. The
training objective is to maximize <!--l. 174--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
class="MathClass-op"> ∏</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo>
  <!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo></math>,
which is equivalent to minimizing the expected negative log odds:
</p>
   <table class="equation-star"><tr><td>

<!--l. 177--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                               <munder class="msub"><mrow 
><mi class="qopname">min</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
><mi 
>𝜃</mi></mrow></munder 
> <mo 
class="MathClass-bin">−</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mi 
>n</mi></mrow></mfrac><munder class="msub"><mrow 
><mo  
>∑</mo>
   </mrow><mrow 
><mi 
>i</mi></mrow></munder 
><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo>
</math></td></tr></table>
<!--l. 181--><p class="indent" >   Considering for now only the decoder <!--l. 181--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
></math>
part of VAE. It maps a sample <!--l. 182--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>z</mi></math> to
<!--l. 182--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>x</mi></mrow><mo accent="true">~</mo></mover></math>, but it can also be viewed as spitting
out parameters for <!--l. 183--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-rel">|</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></math>. More speciﬁcally
it spits out <!--l. 184--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></math>, the parameters in
<!--l. 184--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>N</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">;</mo><msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-punc">,</mo><mi 
>I</mi><mo 
class="MathClass-close">)</mo></math>. If the maximum likelihood method
is to be used for ﬁnding the optimal <!--l. 186--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>𝜃</mi></math>,
<!--l. 186--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math> is needed which can be
calculated this way: <!--l. 187--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo><mi 
class="MathClass-op"> ∫
 <!--nolimits--></mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo><mi 
>d</mi><mi 
>z</mi> <mo 
class="MathClass-rel">=</mo><mi 
class="MathClass-op"> ∫
 <!--nolimits--></mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo><!--nolimits--><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-rel">|</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo><mi 
>d</mi><mi 
>z</mi> <mo 
class="MathClass-rel">=</mo> <mstyle mathvariant="bold"><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mstyle mathvariant="italic"><mi 
>z</mi><mo 
class="MathClass-rel">∼</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></mstyle></mrow></msub 
></mstyle><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-rel">|</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></math>. Estimating
<!--l. 188--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math> this way, however, is intractable
due to the number of dimensions <!--l. 189--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>z</mi></math>
potentially has.
</p><!--l. 191--><p class="indent" >   Assuming there is an eﬀective way of sampling <!--l. 191--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>z</mi></math>
that follows a distribution <!--l. 192--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>, which
may or may not be equal to <!--l. 192--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>,
<!--l. 193--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math> can be
calcualted the following way:
</p>
   <table class="equation-star"><tr><td>
<!--l. 195--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                              <msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo><mo  
> ∫
 <!--nolimits--></mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo><mi 
>d</mi><mi 
>z</mi> <mo 
class="MathClass-rel">=</mo><mo  
> ∫
 <!--nolimits--></mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mfrac><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></mrow>
<mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></mfrac><mi 
>d</mi><mi 
>z</mi> <mo 
class="MathClass-rel">=</mo> <mstyle mathvariant="bold"><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mstyle mathvariant="italic"><mi 
>z</mi><mo 
class="MathClass-rel">∼</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mstyle></mrow></msub 
></mstyle><mfrac><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></mrow> 
<mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></mfrac>
</math></td></tr></table>
<!--l. 198--><p class="indent" >   Note that in the derivation above, the only requirement of <!--l. 198--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>
is to be a valid probability density function. Is there such a <!--l. 199--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>
that is easy to sample from? Yes, that is exactly the responsibility of VAE’s encoder
<!--l. 201--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
></math> which takes in
<!--l. 201--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math> and spits out the parameters
for normal distribution <!--l. 202--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>:
<!--l. 202--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math> and
<!--l. 203--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi></math>).
</p><!--l. 205--><p class="indent" >   With <!--l. 205--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math> estimated
this way, <!--l. 205--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>
becomes:
</p>
   <table class="equation-star"><tr><td>

<!--l. 207--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                            <mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mstyle mathvariant="bold"><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mstyle mathvariant="italic"><mi 
>z</mi><mo 
class="MathClass-rel">∼</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mstyle></mrow></msub 
></mstyle><mfrac><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></mrow> 
<mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></mfrac>
</math></td></tr></table>
<!--l. 212--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.1   </span> <a 
 id="x1-40003.1"></a>Change of Optimization Objective</h4>
<!--l. 214--><p class="noindent" >With all the derivation steps, it is still not clear how to calcuate <!--l. 215--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>
precisely.
</p><!--l. 217--><p class="indent" >   Given <!--l. 217--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">(</mo><mo 
class="MathClass-bin">⋅</mo><mo 
class="MathClass-close">)</mo></math> is a concave function,
Jensen’s inequality states that <!--l. 218--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mstyle mathvariant="bold"><mi 
>E</mi></mstyle><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">≥</mo><mstyle mathvariant="bold"><mi 
>E</mi></mstyle><mo 
class="MathClass-open">(</mo><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo></math>.
We thus have:
</p>
   <table class="equation-star"><tr><td>
<!--l. 220--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                 <mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mstyle mathvariant="bold"><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mstyle mathvariant="italic"><mi 
>z</mi><mo 
class="MathClass-rel">∼</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mstyle></mrow></msub 
></mstyle><mfrac><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></mrow> 
<mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></mfrac> <mo 
class="MathClass-rel">≥</mo><mstyle mathvariant="bold"><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mstyle mathvariant="italic"><mi 
>z</mi><mo 
class="MathClass-rel">∼</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mstyle></mrow></msub 
></mstyle><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--> <mfrac><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></mrow> 
<mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></mfrac>
</math></td></tr></table>
<!--l. 224--><p class="indent" >   It is now possible to estimate the right hand side of the inequality, broadly known as the <span 
class="ecbx-1000">Evidence Lower BOund </span>(ELBO), which can be
rewritten further:
</p><!--l. 228--><p class="indent" >
</p><!--tex4ht:inline--><!--l. 233--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mtable 
columnalign="left" class="align">
                                   <mtr><mtd 
columnalign="right" class="align-odd"><mstyle mathvariant="normal"><mi 
>E</mi><mi 
>L</mi><mi 
>B</mi><mi 
>O</mi></mstyle></mtd>                                   <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo><msub><mrow 
> <mstyle mathvariant="bold"><mi 
>E</mi></mstyle></mrow><mrow 
><mstyle mathvariant="italic"><mi 
>z</mi><mo 
class="MathClass-rel">∼</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mstyle></mrow></msub 
><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--> <mfrac><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></mrow> 
<mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></mfrac><mspace width="2em"/></mtd>                                                      <mtd 
columnalign="right" class="align-label"></mtd>                                   <mtd 
class="align-label">
                                   <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>                                        <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo> <mstyle mathvariant="bold"><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mstyle mathvariant="italic"><mi 
>z</mi><mo 
class="MathClass-rel">∼</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mstyle></mrow></msub 
></mstyle><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--> <mfrac><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-rel">|</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></mrow> 
   <mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></mfrac>   <mspace width="2em"/></mtd>                                                   <mtd 
columnalign="right" class="align-label"></mtd>                                   <mtd 
class="align-label">
                                   <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>                                        <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo> <mstyle mathvariant="bold"><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mstyle mathvariant="italic"><mi 
>z</mi><mo 
class="MathClass-rel">∼</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mstyle></mrow></msub 
></mstyle><mo 
class="MathClass-open">[</mo><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-rel">|</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">−</mo><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">]</mo><mspace width="2em"/></mtd>                                   <mtd 
columnalign="right" class="align-label"></mtd>                                   <mtd 
class="align-label">
                                   <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>                                        <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo> <mstyle mathvariant="bold"><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mstyle mathvariant="italic"><mi 
>z</mi><mo 
class="MathClass-rel">∼</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mstyle></mrow></msub 
></mstyle><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-rel">|</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">−</mo><mstyle mathvariant="normal"><mi 
>K</mi><mi 
>L</mi></mstyle><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-punc">,</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo><mspace width="2em"/></mtd>                                                                         <mtd 
columnalign="right" class="align-label"><mstyle 
   id="x1-4001r7"  class="label" ></mstyle><!--endlabel--><mstyle 
class="maketag"><mtext  >(7)</mtext></mstyle><mspace width="0.33em" class="nbsp" />
   </mtd></mtr></mtable></math>
<!--l. 235--><p class="indent" >   Since <!--l. 235--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo> <mi 
>N</mi><mo 
class="MathClass-open">(</mo><mn>0</mn><mo 
class="MathClass-punc">,</mo><mi 
>I</mi><mo 
class="MathClass-close">)</mo></math>,
the second term in (<a 
href="#x1-4001r7">7<!--tex4ht:ref: eq:elbo --></a>), as already calculated by (<a 
href="#x1-2003r3">3<!--tex4ht:ref: eq:pre-kl-loss --></a>) in Section <a 
href="#x1-20002">2<!--tex4ht:ref: sec:Intuition --></a>, is:
</p>
   <table class="equation-star"><tr><td>

<!--l. 239--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                <mstyle mathvariant="normal"><mi 
>K</mi><mi 
>L</mi></mstyle><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-punc">,</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>2</mn></mrow></mfrac><munderover accentunder="false" accent="false"><mrow  
><mo  
>∑</mo>
  </mrow><mrow 
><mi 
>k</mi><mo 
class="MathClass-rel">=</mo><mn>1</mn></mrow><mrow 
><mi 
>d</mi></mrow></munderover 
><mo 
class="MathClass-open">(</mo><msubsup><mrow 
><mi 
>μ</mi></mrow><mrow 
>
<mi 
>ϕ</mi><mo 
class="MathClass-punc">,</mo><mi 
>k</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
> <mo 
class="MathClass-bin">+</mo> <msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
>
<mi 
>ϕ</mi><mo 
class="MathClass-punc">,</mo><mi 
>k</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
> <mo 
class="MathClass-bin">−</mo><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
>
<mi 
>ϕ</mi><mo 
class="MathClass-punc">,</mo><mi 
>k</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
> <mo 
class="MathClass-bin">−</mo> <mn>1</mn><mo 
class="MathClass-close">)</mo>
</math></td></tr></table>
<!--l. 243--><p class="indent" >   At the beginning of this section, <!--l. 243--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-rel">|</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></math> is
already required to take the form of <!--l. 244--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>N</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-punc">,</mo><mi 
>I</mi><mo 
class="MathClass-close">)</mo></math>
which means:
</p>
   <table class="equation-star"><tr><td>
<!--l. 246--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                            <mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-rel">|</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msup><mrow 
><mo 
class="MathClass-open">(</mo><mn>2</mn><mi 
>π</mi><mo 
class="MathClass-close">)</mo></mrow><mrow 
><mo 
class="MathClass-bin">−</mo><mfrac><mrow 
><mi 
>d</mi></mrow>
<mrow 
><mn>2</mn></mrow></mfrac> </mrow></msup 
><mi class="qopname"> exp</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">(</mo><mo 
class="MathClass-bin">−</mo><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>2</mn></mrow></mfrac><msup><mrow 
> <mrow><mo fence="true" form="prefix"> ∥</mo><mrow><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></mrow><mo fence="true" form="postfix">∥</mo></mrow></mrow><mrow 
><mn>2</mn></mrow></msup 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo> <mstyle mathvariant="normal"><mi 
>c</mi><mi 
>o</mi><mi 
>n</mi><mi 
>s</mi><mi 
>t</mi></mstyle> <mo 
class="MathClass-bin">−</mo><mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>2</mn></mrow></mfrac><msup><mrow 
> <mrow><mo fence="true" form="prefix"> ∥</mo><mrow><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></mrow><mo fence="true" form="postfix">∥</mo></mrow></mrow><mrow 
><mn>2</mn></mrow></msup 
>
</math></td></tr></table>
<!--l. 249--><p class="indent" >   If in the process of estimating <!--l. 249--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mstyle mathvariant="bold"><mi 
>E</mi></mstyle></mrow><mrow 
><mi 
>z</mi><mo 
class="MathClass-rel">∼</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-rel">|</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></math>,
only one single sample <!--l. 250--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>z</mi></math>
drawn which is equal to <!--l. 250--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <mi 
>S</mi><mo 
class="MathClass-open">(</mo><mn>0</mn><mo 
class="MathClass-punc">,</mo><mi 
>I</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">⊙</mo> <msub><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo></math>,
the ﬁrst term in (<a 
href="#x1-4001r7">7<!--tex4ht:ref: eq:elbo --></a>) gives </p><table class="equation-star"><tr><td>
<!--l. 252--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                            <mstyle mathvariant="bold"><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mstyle mathvariant="italic"><mi 
>z</mi><mo 
class="MathClass-rel">∼</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mstyle></mrow></msub 
></mstyle><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-rel">|</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">≈</mo><mstyle mathvariant="normal"><mi 
>c</mi><mi 
>o</mi><mi 
>n</mi><mi 
>s</mi><mi 
>t</mi></mstyle> <mo 
class="MathClass-bin">−</mo><mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>2</mn></mrow></mfrac><msup><mrow 
> <mrow><mo fence="true" form="prefix"> ∥</mo><mrow><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <mi 
>S</mi><mo 
class="MathClass-open">(</mo><mn>0</mn><mo 
class="MathClass-punc">,</mo><mi 
>I</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">⊙</mo> <msub><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo></mrow><mo fence="true" form="postfix">∥</mo></mrow></mrow><mrow 
><mn>2</mn></mrow></msup 
>
</math></td></tr></table>
<!--l. 256--><p class="indent" >   Putting the maximum likelihood and the two terms of the ELBO together, we’ve arrived at:
</p><!--l. 259--><p class="indent" >

</p><!--tex4ht:inline--><!--l. 263--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mtable 
columnalign="left" class="align-star">
     <mtr><mtd 
columnalign="right" class="align-odd"><munder class="msub"><mrow 
><mi class="qopname"> min</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
><mi 
>𝜃</mi></mrow></munder 
> <mo 
class="MathClass-bin">−</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mi 
>n</mi></mrow></mfrac><munder class="msub"><mrow 
><mo  
>∑</mo>
   </mrow><mrow 
><mi 
>i</mi></mrow></munder 
><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo></mtd>     <mtd 
class="align-even"> <mo 
class="MathClass-rel">≤</mo><munder class="msub"><mrow 
><mi class="qopname"> min</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
><mi 
>𝜃</mi><mo 
class="MathClass-punc">,</mo><mi 
>ϕ</mi></mrow></munder 
> <mo 
class="MathClass-bin">−</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mi 
>n</mi></mrow></mfrac><munder class="msub"><mrow 
><mo  
>∑</mo>
   </mrow><mrow 
><mi 
>i</mi></mrow></munder 
><mstyle mathvariant="normal"><mi 
>E</mi><mi 
>L</mi><mi 
>B</mi><mi 
>O</mi></mstyle><mspace width="2em"/></mtd>                                                                                <mtd 
columnalign="right" class="align-label"></mtd>     <mtd 
class="align-label">
     <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>                          <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo><munder class="msub"><mrow 
><mi class="qopname"> min</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
><mi 
>𝜃</mi><mo 
class="MathClass-punc">,</mo><mi 
>ϕ</mi></mrow></munder 
> <mo 
class="MathClass-bin">−</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mi 
>n</mi></mrow></mfrac><munder class="msub"><mrow 
><mo  
>∑</mo>
   </mrow><mrow 
><mi 
>i</mi></mrow></munder 
><mo 
class="MathClass-open">(</mo><mstyle mathvariant="normal"><mi 
>c</mi><mi 
>o</mi><mi 
>n</mi><mi 
>s</mi><mi 
>t</mi></mstyle> <mo 
class="MathClass-bin">−</mo><mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>2</mn></mrow></mfrac><msup><mrow 
> <mrow><mo fence="true" form="prefix"> ∥</mo><mrow><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <mi 
>S</mi><mo 
class="MathClass-open">(</mo><mn>0</mn><mo 
class="MathClass-punc">,</mo><mi 
>I</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">⊙</mo> <msub><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo></mrow><mo fence="true" form="postfix">∥</mo></mrow></mrow><mrow 
><mn>2</mn></mrow></msup 
> <mo 
class="MathClass-bin">+</mo> <mstyle mathvariant="normal"><mi 
>c</mi><mi 
>o</mi><mi 
>n</mi><mi 
>s</mi><mi 
>t</mi></mstyle> <mo 
class="MathClass-bin">−</mo><mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>2</mn></mrow></mfrac><munderover accentunder="false" accent="false"><mrow  
><mo  
>∑</mo>
  </mrow><mrow 
><mi 
>k</mi><mo 
class="MathClass-rel">=</mo><mn>1</mn></mrow><mrow 
><mi 
>d</mi></mrow></munderover 
><mo 
class="MathClass-open">(</mo><msubsup><mrow 
><mi 
>μ</mi></mrow><mrow 
>
<mi 
>ϕ</mi><mo 
class="MathClass-punc">,</mo><mi 
>k</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
> <mo 
class="MathClass-bin">+</mo> <msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
>
<mi 
>ϕ</mi><mo 
class="MathClass-punc">,</mo><mi 
>k</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
> <mo 
class="MathClass-bin">−</mo><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
>
<mi 
>ϕ</mi><mo 
class="MathClass-punc">,</mo><mi 
>k</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo><mspace width="2em"/></mtd>     <mtd 
columnalign="right" class="align-label"></mtd>     <mtd 
class="align-label">
     <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>                          <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo> <mstyle mathvariant="normal"><mi 
>c</mi><mi 
>o</mi><mi 
>n</mi><mi 
>s</mi><mi 
>t</mi></mstyle> <mo 
class="MathClass-bin">+</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>2</mn></mrow></mfrac> <mo 
class="MathClass-bin">⋅</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mi 
>n</mi></mrow></mfrac><munder class="msub"><mrow 
><mo  
>∑</mo>
   </mrow><mrow 
><mi 
>i</mi></mrow></munder 
><mo 
class="MathClass-open">(</mo><mrow><mo fence="true" form="prefix"> ∥</mo><mrow><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <mi 
>S</mi><mo 
class="MathClass-open">(</mo><mn>0</mn><mo 
class="MathClass-punc">,</mo><mi 
>I</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">⊙</mo> <msub><mrow 
><mi 
>σ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo></mrow><mo fence="true" form="postfix">∥</mo></mrow> <mo 
class="MathClass-bin">+</mo><munderover accentunder="false" accent="false"><mrow  
><mo  
> ∑</mo>
  </mrow><mrow 
><mi 
>k</mi><mo 
class="MathClass-rel">=</mo><mn>1</mn></mrow><mrow 
><mi 
>d</mi></mrow></munderover 
><mo 
class="MathClass-open">(</mo><msubsup><mrow 
><mi 
>μ</mi></mrow><mrow 
>
<mi 
>ϕ</mi><mo 
class="MathClass-punc">,</mo><mi 
>k</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
> <mo 
class="MathClass-bin">+</mo> <msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
>
<mi 
>ϕ</mi><mo 
class="MathClass-punc">,</mo><mi 
>k</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
> <mo 
class="MathClass-bin">−</mo><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msubsup><mrow 
><mi 
>σ</mi></mrow><mrow 
>
<mi 
>ϕ</mi><mo 
class="MathClass-punc">,</mo><mi 
>k</mi></mrow><mrow 
><mn>2</mn></mrow></msubsup 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo><mspace width="2em"/></mtd>                      <mtd 
columnalign="right" class="align-label"></mtd>     <mtd 
class="align-label">
   <mspace width="2em"/></mtd></mtr></mtable></math>
<!--l. 265--><p class="indent" >   Removing the constants and <!--l. 265--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>2</mn></mrow></mfrac></math>,
our ﬁnal optimization objective shown above is identical to (<a 
href="#x1-2006r6">6<!--tex4ht:ref: eq:total_loss --></a>) in Section <a 
href="#x1-20002">2<!--tex4ht:ref: sec:Intuition --></a>, keeping in mind that </p>
     <ul class="itemize1">
     <li class="itemize"><!--l. 269--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
></math>
     and <!--l. 269--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
></math>
     are the same funcion, and
     </li>
     <li class="itemize">with this theoretical foundation, the need for a <!--l. 270--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>λ</mi></math>
     is also eliminated.</li></ul>
<!--l. 274--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.2   </span> <a 
 id="x1-50003.2"></a>The ELBO gap</h4>
<!--l. 276--><p class="noindent" >Since the optimization objective is changed from the log likelihoods to the ELBO, it is helpful to understand the gap betwen the
two.
</p><!--l. 279--><p class="indent" >
</p><!--tex4ht:inline--><!--l. 285--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mtable 
columnalign="left" class="align-star">
                            <mtr><mtd 
columnalign="right" class="align-odd"><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">−</mo><mstyle mathvariant="bold"><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mstyle mathvariant="italic"><mi 
>z</mi><mo 
class="MathClass-rel">∼</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mstyle></mrow></msub 
></mstyle><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--> <mfrac><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></mrow> 
<mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></mfrac></mtd>                            <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo> <mstyle mathvariant="bold"><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mstyle mathvariant="italic"><mi 
>z</mi><mo 
class="MathClass-rel">∼</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mstyle></mrow></msub 
></mstyle><mo 
class="MathClass-open">(</mo><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">−</mo><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--> <mfrac><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></mrow> 
<mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></mfrac><mo 
class="MathClass-close">)</mo><mspace width="2em"/></mtd>                            <mtd 
columnalign="right" class="align-label"></mtd>                            <mtd 
class="align-label">
                            <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>                                                        <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo> <mstyle mathvariant="bold"><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mstyle mathvariant="italic"><mi 
>z</mi><mo 
class="MathClass-rel">∼</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mstyle></mrow></msub 
></mstyle><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--> <mfrac><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow> 
   <mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></mrow></mfrac>    <mspace width="2em"/></mtd>                                  <mtd 
columnalign="right" class="align-label"></mtd>                            <mtd 
class="align-label">
                            <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>                                                        <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo> <mstyle mathvariant="bold"><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mstyle mathvariant="italic"><mi 
>z</mi><mo 
class="MathClass-rel">∼</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mstyle></mrow></msub 
></mstyle><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--> <mfrac><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow> 
<mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></mfrac><mspace width="2em"/></mtd>                                       <mtd 
columnalign="right" class="align-label"></mtd>                            <mtd 
class="align-label">
                            <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>                                                        <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo> <mstyle mathvariant="normal"><mi 
>K</mi><mi 
>L</mi></mstyle><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo><mspace width="2em"/></mtd>                                        <mtd 
columnalign="right" class="align-label"></mtd>                            <mtd 
class="align-label">
                            <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>                                                        <mtd 
class="align-even"> <mo 
class="MathClass-rel">≥</mo> <mn>0</mn><mspace width="2em"/></mtd>                                                        <mtd 
columnalign="right" class="align-label"></mtd>                            <mtd 
class="align-label">
   <mspace width="2em"/></mtd></mtr></mtable></math>
<!--l. 287--><p class="indent" >   The gap is 0 when <!--l. 287--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>
and <!--l. 287--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math> are
identical.
</p><!--l. 289--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">4   </span> <a 
 id="x1-60004"></a>Joint Distribution View</h3>
<!--l. 291--><p class="noindent" >Section <a 
href="#x1-30003">3<!--tex4ht:ref: sec:Bayesian-View --></a>’s derivation starts from the maximum likelihood objective, and then switches to maximizing the ELBO. This section provides a simpler
joint distribution approach to derive the ELBO objective directly, inspired by Jianlin Su at http://kexue.fm.
</p><!--l. 296--><p class="indent" >   In VAE, once trained, the decoder <!--l. 296--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
></math>
can be used as an independent generative model, without the encoder. The encoder can also be used without the decoder as a descriminative model.
The training process is what links both components together. It is reasonable to require them to work on the same distribution about both
<!--l. 300--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math> and
<!--l. 301--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>z</mi></math>. That is, our objective is to minimize
the K-L divergence between <!--l. 302--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></math>
and <!--l. 302--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></math>:
</p><!--l. 304--><p class="indent" >
</p><!--tex4ht:inline--><!--l. 318--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mtable 
columnalign="left" class="align-star">
                 <mtr><mtd 
columnalign="right" class="align-odd"><munder class="msub"><mrow 
><mi class="qopname"> min</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
><mi 
>ϕ</mi><mo 
class="MathClass-punc">,</mo><mi 
>𝜃</mi></mrow></munder 
><mstyle mathvariant="normal"><mi 
>K</mi><mi 
>L</mi></mstyle><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo></mtd>                 <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo><munder class="msub"><mrow 
><mi class="qopname"> min</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
><mi 
>ϕ</mi><mo 
class="MathClass-punc">,</mo><mi 
>𝜃</mi></mrow></munder 
><mo  
> ∫
 <!--nolimits--></mo><!--nolimits--><mo  
>∫
 <!--nolimits--></mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--> <mfrac><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></mrow> 
<mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></mrow></mfrac><mi 
>d</mi><mi 
>z</mi><mi 
>d</mi><mi 
>x</mi><mspace width="2em"/></mtd>                                              <mtd 
columnalign="right" class="align-label"></mtd>                 <mtd 
class="align-label">
                 <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>                                         <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo><munder class="msub"><mrow 
><mi class="qopname"> min</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
><mi 
>ϕ</mi><mo 
class="MathClass-punc">,</mo><mi 
>𝜃</mi></mrow></munder 
><mo  
> ∫
 <!--nolimits--></mo><!--nolimits--><mo  
>∫
 <!--nolimits--></mo><!--nolimits--><mo 
class="MathClass-open">[</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--> <mfrac><mrow 
><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow> 
   <mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></mrow></mfrac>   <mi 
>d</mi><mi 
>z</mi><mo 
class="MathClass-close">]</mo><mi 
>d</mi><mi 
>x</mi><mspace width="2em"/></mtd>                                       <mtd 
columnalign="right" class="align-label"></mtd>                 <mtd 
class="align-label">
                 <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>                                         <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo><munder class="msub"><mrow 
><mi class="qopname"> min</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
><mi 
>ϕ</mi><mo 
class="MathClass-punc">,</mo><mi 
>𝜃</mi></mrow></munder 
><mo  
> ∫
 <!--nolimits--></mo><!--nolimits--><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-open">[</mo><mo  
>∫
 <!--nolimits--></mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--> <mfrac><mrow 
><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow> 
   <mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></mrow></mfrac>   <mi 
>d</mi><mi 
>z</mi><mo 
class="MathClass-close">]</mo><mi 
>d</mi><mi 
>x</mi><mspace width="2em"/></mtd>                                       <mtd 
columnalign="right" class="align-label"></mtd>                 <mtd 
class="align-label">
                 <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>                                         <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo><munder class="msub"><mrow 
><mi class="qopname"> min</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
><mi 
>ϕ</mi><mo 
class="MathClass-punc">,</mo><mi 
>𝜃</mi></mrow></munder 
><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-rel">∼</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><mo 
class="MathClass-open">[</mo><mo  
>∫
 <!--nolimits--></mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--> <mfrac><mrow 
><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow> 
   <mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></mrow></mfrac>   <mi 
>d</mi><mi 
>z</mi><mo 
class="MathClass-close">]</mo><mspace width="2em"/></mtd>                                        <mtd 
columnalign="right" class="align-label"></mtd>                 <mtd 
class="align-label">
                 <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>                                         <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo><munder class="msub"><mrow 
><mi class="qopname"> min</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
><mi 
>ϕ</mi><mo 
class="MathClass-punc">,</mo><mi 
>𝜃</mi></mrow></munder 
><mo 
class="MathClass-open">[</mo><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-rel">∼</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><mo  
> ∫
 <!--nolimits--></mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mi 
>d</mi><mi 
>z</mi> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-rel">∼</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><mo  
> ∫
 <!--nolimits--></mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--> <mfrac><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow> 
<mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></mrow></mfrac><mi 
>d</mi><mi 
>z</mi><mo 
class="MathClass-close">]</mo><mspace width="2em"/></mtd>                 <mtd 
columnalign="right" class="align-label"></mtd>                 <mtd 
class="align-label">
                 <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>                                         <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo><munder class="msub"><mrow 
><mi class="qopname"> min</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
><mi 
>ϕ</mi><mo 
class="MathClass-punc">,</mo><mi 
>𝜃</mi></mrow></munder 
><mo 
class="MathClass-open">[</mo><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-rel">∼</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-rel">∼</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><mo  
> ∫
 <!--nolimits--></mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--> <mfrac><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow> 
<mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></mrow></mfrac><mi 
>d</mi><mi 
>z</mi><mo 
class="MathClass-close">]</mo><mspace width="2em"/></mtd>                            <mtd 
columnalign="right" class="align-label"></mtd>                 <mtd 
class="align-label">
                 <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>                                         <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo><munder class="msub"><mrow 
><mi class="qopname"> min</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
><mi 
>ϕ</mi><mo 
class="MathClass-punc">,</mo><mi 
>𝜃</mi></mrow></munder 
><mo 
class="MathClass-open">[</mo><mstyle mathvariant="normal"><mi 
>c</mi><mi 
>o</mi><mi 
>n</mi><mi 
>s</mi><mi 
>t</mi></mstyle> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-rel">∼</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><mo  
> ∫
 <!--nolimits--></mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--> <mfrac><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow> 
<mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></mrow></mfrac><mi 
>d</mi><mi 
>z</mi><mo 
class="MathClass-close">]</mo><mspace width="2em"/></mtd>                                     <mtd 
columnalign="right" class="align-label"></mtd>                 <mtd 
class="align-label">
                 <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>                                         <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo> <mstyle mathvariant="normal"><mi 
>c</mi><mi 
>o</mi><mi 
>n</mi><mi 
>s</mi><mi 
>t</mi></mstyle> <mo 
class="MathClass-bin">+</mo><munder class="msub"><mrow 
><mi class="qopname"> min</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
><mi 
>ϕ</mi><mo 
class="MathClass-punc">,</mo><mi 
>𝜃</mi></mrow></munder 
><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-rel">∼</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><mo  
> ∫
 <!--nolimits--></mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--> <mfrac><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow> 
<mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></mrow></mfrac><mi 
>d</mi><mi 
>z</mi><mspace width="2em"/></mtd>                                      <mtd 
columnalign="right" class="align-label"></mtd>                 <mtd 
class="align-label">
                 <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>                                         <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo> <mstyle mathvariant="normal"><mi 
>c</mi><mi 
>o</mi><mi 
>n</mi><mi 
>s</mi><mi 
>t</mi></mstyle> <mo 
class="MathClass-bin">+</mo><munder class="msub"><mrow 
><mi class="qopname"> min</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
><mi 
>ϕ</mi><mo 
class="MathClass-punc">,</mo><mi 
>𝜃</mi></mrow></munder 
><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-rel">∼</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><mo  
> ∫
 <!--nolimits--></mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--> <mfrac><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow> 
<mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></mrow></mfrac><mi 
>d</mi><mi 
>z</mi><mspace width="2em"/></mtd>                                      <mtd 
columnalign="right" class="align-label"></mtd>                 <mtd 
class="align-label">
                 <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>                                         <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo> <mstyle mathvariant="normal"><mi 
>c</mi><mi 
>o</mi><mi 
>n</mi><mi 
>s</mi><mi 
>t</mi></mstyle> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-rel">∼</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><mo  
> ∫
 <!--nolimits--></mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits-->   <mfrac><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow> 
<mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-rel">|</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></mrow></mfrac><mi 
>d</mi><mi 
>z</mi><mspace width="2em"/></mtd>                                        <mtd 
columnalign="right" class="align-label"></mtd>                 <mtd 
class="align-label">
                 <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>                                         <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo> <mstyle mathvariant="normal"><mi 
>c</mi><mi 
>o</mi><mi 
>n</mi><mi 
>s</mi><mi 
>t</mi></mstyle> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-rel">∼</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><mo 
class="MathClass-open">[</mo><mo 
class="MathClass-bin">−</mo><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>z</mi><mo 
class="MathClass-rel">∼</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-rel">|</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>z</mi><mo 
class="MathClass-rel">∼</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--> <mfrac><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow> 
  <mrow 
><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></mrow></mfrac>  <mo 
class="MathClass-close">]</mo><mspace width="2em"/></mtd>                         <mtd 
columnalign="right" class="align-label"></mtd>                 <mtd 
class="align-label">
                 <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>                                         <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo> <mstyle mathvariant="normal"><mi 
>c</mi><mi 
>o</mi><mi 
>n</mi><mi 
>s</mi><mi 
>t</mi></mstyle> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-rel">∼</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><mo 
class="MathClass-open">[</mo><mo 
class="MathClass-bin">−</mo><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>z</mi><mo 
class="MathClass-rel">∼</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-rel">|</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <mstyle mathvariant="normal"><mi 
>K</mi><mi 
>L</mi></mstyle><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-punc">,</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">]</mo><mspace width="2em"/></mtd>                            <mtd 
columnalign="right" class="align-label"></mtd>                 <mtd 
class="align-label">
                 <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>                                         <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo> <mstyle mathvariant="normal"><mi 
>c</mi><mi 
>o</mi><mi 
>n</mi><mi 
>s</mi><mi 
>t</mi></mstyle> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-rel">∼</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><mo 
class="MathClass-open">[</mo><mo 
class="MathClass-bin">−</mo><mstyle mathvariant="normal"><mi 
>E</mi><mi 
>L</mi><mi 
>B</mi><mi 
>O</mi></mstyle><mo 
class="MathClass-close">]</mo><mspace width="2em"/></mtd>                                                        <mtd 
columnalign="right" class="align-label"></mtd>                 <mtd 
class="align-label">
   <mspace width="2em"/></mtd></mtr></mtable></math>
<!--l. 320--><p class="indent" >   The deﬁnition of the ELBO in Section <a 
href="#x1-30003">3<!--tex4ht:ref: sec:Bayesian-View --></a> can be used to verify this.
</p><!--l. 323--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">5   </span> <a 
 id="x1-70005"></a>Latent Space</h3>
<!--l. 325--><p class="noindent" >In VAE’s training process, <!--l. 325--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>
and <!--l. 325--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo> <mi 
>N</mi><mo 
class="MathClass-open">(</mo><mn>0</mn><mo 
class="MathClass-punc">,</mo><mi 
>I</mi><mo 
class="MathClass-close">)</mo></math> are given,
VAE learns <!--l. 326--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math> and
<!--l. 326--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-rel">|</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></math> simultaneously. Note
however that <!--l. 327--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math> is never
directly optimized to match <!--l. 328--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-punc">.</mo></math>
This could be one major reason why VAE is not known to generate very realistic images.
</p><!--l. 331--><p class="indent" >   VAE’s encoder, on the other hand, is a very reasonable feature extraction tool. Suppose there are a bunch
of sample human face pictures labelled with whether the person has large eyes or not. Denote these samples by
<!--l. 334--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo></math> where
<!--l. 334--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math> is the image, and
<!--l. 334--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>y</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn></math> if the person has large eyes
and 0 otherwise. A vector <!--l. 335--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>e</mi></math>
in <!--l. 335--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>ℤ</mi></math>
calculated the following way probably captures the latent representation of large eyes.
</p>
   <table class="equation-star"><tr><td>
<!--l. 339--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                        <mi 
>e</mi> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-rel">∼</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-rel">|</mo><mi 
>y</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn><mo 
class="MathClass-close">)</mo></mrow></msub 
><msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-rel">∼</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-rel">|</mo><mi 
>y</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn><mo 
class="MathClass-close">)</mo></mrow></msub 
><msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>ϕ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo>
</math></td></tr></table>
<!--l. 343--><p class="indent" >   Given any human face picture <!--l. 343--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>,
<!--l. 343--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>𝜃</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi> <mo 
class="MathClass-bin">+</mo> <mi 
>λ</mi><mi 
>e</mi><mo 
class="MathClass-close">)</mo></math> should generate
a variation of <!--l. 344--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math> that has
big or small eyes as <!--l. 344--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>λ</mi></math>
varies. </p> 
</body> 
</html>


