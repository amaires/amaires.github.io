<!DOCTYPE html> 
<html lang="en" xml:lang="en" > 
<head><title>Generative Adversarial Networks</title> 
<meta  charset="utf-8" /> 
<meta name="generator" content="TeX4ht (https://tug.org/tex4ht/)" /> 
<meta name="viewport" content="width=device-width,initial-scale=1" /> 
<link rel="stylesheet" type="text/css" href="GAN.css" /> 
<meta name="src" content="GAN.tex" /> 
</head><body 
>
   <div class="maketitle">


<h2 class="titleHead">Generative Adversarial Networks</h2>
<div class="author" ><span 
class="ecrm-1200">Amaires@June 2024</span></div><br />
<div class="date" ></div>
   </div>Generative Adversarial Networks (GAN) are an approach to generative artiï¬cial intelligence. It is the ï¬rst known model to produce new
photorealistic images automatically.
   <h3 class="sectionHead"><span class="titlemark">1   </span> <a 
 id="x1-10001"></a>Original GAN</h3>
<!--l. 34--><p class="noindent" >With data samples <!--l. 34--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>áº‹</mi></math> that follow a
certain unknown distribution <!--l. 35--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>, the idea
is to have a neural network generator <!--l. 35--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
></math>,
parameterized by <!--l. 36--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>ğœƒ</mi></math>, which
transforms samples <!--l. 36--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>z</mi> <mo 
class="MathClass-rel">âˆ¼</mo> <mi 
>N</mi><mo 
class="MathClass-open">(</mo><mn>0</mn><mo 
class="MathClass-punc">,</mo><mi 
>I</mi><mo 
class="MathClass-close">)</mo></math>
to <!--l. 37--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>x</mi></mrow><mo accent="true">~</mo></mover></math> that
follows <!--l. 37--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>.
Figure <a 
href="#x1-10011">1<!--tex4ht:ref: fig:Generator --></a> depicts the architecture. </p><figure class="figure"> 

<a 
 id="x1-10011"></a>
<!--l. 41--><p class="noindent" ><img 
src="pyx_gan_arch_1.svg" alt="PIC"  
 /><br />
</p>
<figcaption class="caption" ><span class="id">FigureÂ 1:</span><span  
class="content">Generator
<!--l. 43--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
></math></span></figcaption><!--tex4ht:label?: x1-10011 -->
   </figure>
<!--l. 46--><p class="indent" >   In order to train <!--l. 46--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
></math>, some
optimization objective is needed to give <!--l. 47--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
></math>
feedback about whether <!--l. 47--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>x</mi></mrow><mo accent="true">~</mo></mover></math> really
looks like it is drawn from <!--l. 48--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>. A
binary descriminator/classiï¬er <!--l. 48--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
></math>
that returns the probability that <!--l. 49--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>x</mi></mrow><mo accent="true">~</mo></mover></math>
follows <!--l. 49--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>
would serve the purpose. Figure <a 
href="#x1-10022">2<!--tex4ht:ref: fig:Generator-Discrim --></a> shows the architecture we have so far. </p><figure class="figure"> 

<a 
 id="x1-10022"></a>
<!--l. 54--><p class="noindent" ><img 
src="pyx_gan_arch_2.svg" alt="PIC"  
 /><br />
</p>
<figcaption class="caption" ><span class="id">FigureÂ 2:</span><span  
class="content">Generator
<!--l. 57--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
></math>
and                                                                                                                                                              Discriminator
<!--l. 57--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
></math></span></figcaption><!--tex4ht:label?: x1-10022 -->
   </figure>
<!--l. 59--><p class="indent" >   The introduction of <!--l. 59--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
></math> merely
defers the responsibility of guiding <!--l. 60--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
></math>.
How do we train <!--l. 60--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
></math>? We could
feed it both real samples <!--l. 61--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-open">(</mo><mi 
>áº‹</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn><mo 
class="MathClass-close">)</mo></math>
and artiï¬cial samples <!--l. 61--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-open">(</mo><mover 
accent="true"><mrow 
><mi 
>x</mi></mrow><mo accent="true">~</mo></mover><mo 
class="MathClass-punc">,</mo><mn>0</mn><mo 
class="MathClass-close">)</mo></math>
created by <!--l. 62--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
></math>.
Figure <a 
href="#x1-10033">3<!--tex4ht:ref: fig:gan-complete --></a> shows the complete GAN architecture. </p><figure class="figure"> 

<a 
 id="x1-10033"></a>
<!--l. 66--><p class="noindent" ><img 
src="pyx_gan_arch_3.svg" alt="PIC"  
 /><br />
</p>
<figcaption class="caption" ><span class="id">FigureÂ 3:</span><span  
class="content">The Complete GAN Architecture</span></figcaption><!--tex4ht:label?: x1-10033 -->
   </figure>
<!--l. 71--><p class="indent" >   The loss function <!--l. 71--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>â„’</mi> </math>
of <!--l. 71--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
></math> is
the common binary cross entropy function, shown below (see <a 
href="amaires.github.io/OptimizationObjective/" class="url" ><span 
class="ectt-1000">amaires.github.io/OptimizationObjective/</span></a> for a refresher): </p><table class="equation"><tr><td>
<a 
 id="x1-1004r1"></a>
<!--l. 74--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                <mi 
>â„’</mi>   <mo 
class="MathClass-rel">=</mo><munder class="msub"><mrow 
><mi class="qopname"> min</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></munder 
> <mo 
class="MathClass-bin">âˆ’</mo> <msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-rel">âˆ¼</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>y</mi><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <mo 
class="MathClass-open">(</mo><mn>1</mn> <mo 
class="MathClass-bin">âˆ’</mo> <mi 
>y</mi><mo 
class="MathClass-close">)</mo><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">(</mo><mn>1</mn> <mo 
class="MathClass-bin">âˆ’</mo> <msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo>
</math></td><td class="eq-no">(1)</td></tr></table>
<!--l. 77--><p class="indent" >   Remove the negation in (<a 
href="#x1-1004r1">1<!--tex4ht:ref: eq:opti-obj --></a>) and rewrite it in conditional expectation form:
</p><!--tex4ht:inline--><!--l. 82--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mtable 
columnalign="left" class="align-star">
                        <mtr><mtd 
columnalign="right" class="align-odd"><mi 
>â„’</mi> </mtd>                        <mtd 
class="align-even">  <mo 
class="MathClass-rel">=</mo><munder class="msub"><mrow 
><mi class="qopname"> max</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
><mi 
>Ï•</mi></mrow></munder 
><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>y</mi><mo 
class="MathClass-rel">âˆ¼</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-rel">âˆ¼</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-rel">|</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>y</mi><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <mo 
class="MathClass-open">(</mo><mn>1</mn> <mo 
class="MathClass-bin">âˆ’</mo> <mi 
>y</mi><mo 
class="MathClass-close">)</mo><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">(</mo><mn>1</mn> <mo 
class="MathClass-bin">âˆ’</mo> <msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo><mspace width="2em"/></mtd>                                      <mtd 
columnalign="right" class="align-label"></mtd>                        <mtd 
class="align-label">
                        <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>                          <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo><munder class="msub"><mrow 
><mi class="qopname"> max</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
><mi 
>Ï•</mi></mrow></munder 
><mo 
class="MathClass-open">[</mo><mstyle mathvariant="normal"><mi 
>P</mi><mi 
>r</mi></mstyle><mo 
class="MathClass-open">(</mo><mi 
>y</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><mo 
class="MathClass-close">)</mo><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-rel">âˆ¼</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-rel">|</mo><mi 
>y</mi><mo 
class="MathClass-rel">=</mo><mn>1</mn><mo 
class="MathClass-close">)</mo></mrow></msub 
><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <mstyle mathvariant="normal"><mi 
>P</mi><mi 
>r</mi></mstyle><mo 
class="MathClass-open">(</mo><mi 
>y</mi> <mo 
class="MathClass-rel">=</mo> <mn>0</mn><mo 
class="MathClass-close">)</mo><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-rel">âˆ¼</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-rel">|</mo><mi 
>y</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn><mo 
class="MathClass-close">)</mo></mrow></msub 
><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">(</mo><mn>1</mn> <mo 
class="MathClass-bin">âˆ’</mo> <msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">]</mo><mspace width="2em"/></mtd>                        <mtd 
columnalign="right" class="align-label"></mtd>                        <mtd 
class="align-label">
   <mspace width="2em"/></mtd></mtr></mtable></math>
<!--l. 83--><p class="noindent" >If the same number of real samples <!--l. 83--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>áº‹</mi></math>
and artiï¬cial samples <!--l. 84--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>x</mi></mrow><mo accent="true">~</mo></mover></math>
are fed to <!--l. 84--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
></math> in each
batch/mini-batch, <!--l. 84--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>P</mi><mi 
>r</mi><mo 
class="MathClass-open">(</mo><mi 
>y</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo> <mi 
>P</mi><mi 
>r</mi><mo 
class="MathClass-open">(</mo><mi 
>y</mi> <mo 
class="MathClass-rel">=</mo> <mn>0</mn><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>2</mn></mrow></mfrac></math>.
Also note that <!--l. 85--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi> <mo 
class="MathClass-rel">âˆ¼</mo> <mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-rel">|</mo><mi 
>y</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><mo 
class="MathClass-close">)</mo></math>
is the same as <!--l. 85--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>áº‹</mi> <mo 
class="MathClass-rel">âˆ¼</mo> <mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>áº‹</mi><mo 
class="MathClass-close">)</mo></math>
and <!--l. 86--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi> <mo 
class="MathClass-rel">âˆ¼</mo> <mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-rel">|</mo><mi 
>y</mi> <mo 
class="MathClass-rel">=</mo> <mn>0</mn><mo 
class="MathClass-close">)</mo></math> is the
same as <!--l. 86--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>x</mi></mrow><mo accent="true">~</mo></mover> <mo 
class="MathClass-rel">âˆ¼</mo> <msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mover 
accent="true"><mrow 
><mi 
>x</mi></mrow><mo accent="true">~</mo></mover><mo 
class="MathClass-rel">|</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></math>,
<!--l. 87--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>â„’</mi> </math> can be
further written:
</p><!--l. 89--><p class="indent" >
</p><!--tex4ht:inline--><!--l. 92--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mtable 
columnalign="left" class="align-star">
                            <mtr><mtd 
columnalign="right" class="align-odd"><mi 
>â„’</mi> </mtd>                            <mtd 
class="align-even">  <mo 
class="MathClass-rel">=</mo><munder class="msub"><mrow 
><mi class="qopname"> max</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
><mi 
>Ï•</mi></mrow></munder 
><mo 
class="MathClass-open">[</mo><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>2</mn></mrow></mfrac><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>áº‹</mi><mo 
class="MathClass-rel">âˆ¼</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>áº‹</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo></mrow></msub 
><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>áº‹</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>2</mn></mrow></mfrac><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mover 
accent="true"><mrow 
><mi 
>x</mi></mrow><mo accent="true">~</mo></mover><mo 
class="MathClass-rel">âˆ¼</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mover 
accent="true"><mrow 
><mi 
>x</mi></mrow><mo accent="true">~</mo></mover><mo 
class="MathClass-close">)</mo></mrow></msub 
><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">(</mo><mn>1</mn> <mo 
class="MathClass-bin">âˆ’</mo> <msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mover 
accent="true"><mrow 
><mi 
>x</mi></mrow><mo accent="true">~</mo></mover><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">]</mo><mspace width="2em"/></mtd>                                      <mtd 
columnalign="right" class="align-label"></mtd>                            <mtd 
class="align-label">
                            <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"><mi 
>L</mi></mtd>                             <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo><munder class="msub"><mrow 
><mi class="qopname"> max</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
><mi 
>Ï•</mi></mrow></munder 
><mo 
class="MathClass-open">[</mo><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>2</mn></mrow></mfrac><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>áº‹</mi><mo 
class="MathClass-rel">âˆ¼</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>áº‹</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo></mrow></msub 
><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>áº‹</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>2</mn></mrow></mfrac><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>z</mi><mo 
class="MathClass-rel">âˆ¼</mo><mi 
>N</mi><mo 
class="MathClass-open">(</mo><mn>0</mn><mo 
class="MathClass-punc">,</mo><mi 
>I</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mover 
accent="true"><mrow 
><mi 
>x</mi></mrow><mo accent="true">~</mo></mover><mo 
class="MathClass-rel">âˆ¼</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mover 
accent="true"><mrow 
><mi 
>x</mi></mrow><mo accent="true">~</mo></mover><mo 
class="MathClass-rel">|</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">(</mo><mn>1</mn> <mo 
class="MathClass-bin">âˆ’</mo> <msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mover 
accent="true"><mrow 
><mi 
>x</mi></mrow><mo accent="true">~</mo></mover><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">]</mo><mspace width="2em"/></mtd>                            <mtd 
columnalign="right" class="align-label"></mtd>                            <mtd 
class="align-label">
   <mspace width="2em"/></mtd></mtr></mtable></math>
After removing the constant <!--l. 93--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>2</mn></mrow></mfrac></math>,
if for every sample <!--l. 93--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>z</mi></math>, only
one sample is drawn for <!--l. 94--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>x</mi></mrow><mo accent="true">~</mo></mover></math>,
which is what <!--l. 94--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
></math>does,
<!--l. 95--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>â„’</mi> </math> becomes
<table class="equation-star"><tr><td>
<!--l. 96--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                              <mi 
>â„’</mi>   <mo 
class="MathClass-rel">=</mo><munder class="msub"><mrow 
><mi class="qopname"> max</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
><mi 
>Ï•</mi></mrow></munder 
><mo 
class="MathClass-open">[</mo><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>áº‹</mi><mo 
class="MathClass-rel">âˆ¼</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>áº‹</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo></mrow></msub 
><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>áº‹</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>z</mi><mo 
class="MathClass-rel">âˆ¼</mo><mi 
>N</mi><mo 
class="MathClass-open">(</mo><mn>0</mn><mo 
class="MathClass-punc">,</mo><mi 
>I</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">(</mo><mn>1</mn> <mo 
class="MathClass-bin">âˆ’</mo> <msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">]</mo>
</math></td></tr></table>
<!--l. 99--><p class="indent" >   Note that the objective is parameterized by both <!--l. 99--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>ğœƒ</mi></math>
and <!--l. 99--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Ï•</mi></math>, but it is maximized only in terms
of <!--l. 100--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Ï•</mi></math>, the paramters for the discriminator.
It is also worth noting that <!--l. 101--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
></math> gives the
probability if a sample follows <!--l. 102--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>,
but not <!--l. 102--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math> itself.
Also, <!--l. 103--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
></math> generates
a sample <!--l. 103--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>x</mi></mrow><mo accent="true">~</mo></mover></math>,
not <!--l. 103--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mover 
accent="true"><mrow 
><mi 
>x</mi></mrow><mo accent="true">~</mo></mover><mo 
class="MathClass-close">)</mo></math>.
</p><!--l. 105--><p class="indent" >   The process so far optimizes <!--l. 105--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Ï•</mi></math> to make
<!--l. 105--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
></math> better at telling real samples apart from samples
created by a ï¬xed <!--l. 106--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
></math>. For each batc/mini-batch
of samples, <!--l. 107--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Ï•</mi></math> takes a gradient <span 
class="ecti-1000">ascent </span>step.
This process does not seem to improve <!--l. 108--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
></math>
whatsoever. If <!--l. 109--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>ğœƒ</mi></math> also takes a gradient
ascent step using <!--l. 109--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
class="MathClass-op">âˆ‡</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mi 
>â„’</mi> </math>, it also makes
<!--l. 110--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
></math> better. In this case, it is probably
equivalent to making samples created by <!--l. 111--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
></math>
more obviously fake, the opposite of what we want. The solution to this last piece of the GAN puzzle is to update
<!--l. 113--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>ğœƒ</mi></math> with a
gradient <span 
class="ecti-1000">descent </span>step. More formally, our objective function is </p><table class="equation-star"><tr><td>
<!--l. 115--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                            <mi 
>â„’</mi>   <mo 
class="MathClass-rel">=</mo><munder class="msub"><mrow 
><mi class="qopname"> min</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></munder 
><munder class="msub"><mrow 
><mi class="qopname"> max</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
><mi 
>Ï•</mi></mrow></munder 
><mo 
class="MathClass-open">[</mo><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>áº‹</mi><mo 
class="MathClass-rel">âˆ¼</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>áº‹</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo></mrow></msub 
><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>áº‹</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>z</mi><mo 
class="MathClass-rel">âˆ¼</mo><mi 
>N</mi><mo 
class="MathClass-open">(</mo><mn>0</mn><mo 
class="MathClass-punc">,</mo><mi 
>I</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">(</mo><mn>1</mn> <mo 
class="MathClass-bin">âˆ’</mo> <msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">]</mo>
</math></td></tr></table>
<!--l. 118--><p class="indent" >   Intuitively, <!--l. 118--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
></math> tries to tell real samples
apart from artiï¬cial samples, and <!--l. 119--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
></math>
tries to create artiï¬cial samples that are hard to distinguish from real samples, hence the name generative adversarial network.
</p><!--l. 123--><p class="indent" >   In GAN, <!--l. 123--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math> and
<!--l. 123--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
></math> are never explicitly
modeled. <!--l. 123--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
></math> can produce good
samples following <!--l. 124--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>, but it
does not know the form of <!--l. 125--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>.
In other words, <!--l. 125--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
></math>
deï¬nes a sampling process without knowing its distribution.
</p>
   <h4 class="subsectionHead"><span class="titlemark">1.1   </span> <a 
 id="x1-20001.1"></a>Jenson-Shannon Divergence</h4>
<!--l. 130--><p class="noindent" >For a given <!--l. 130--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
></math>,
<!--l. 130--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
></math>â€™s objective
is to maximize
</p><!--tex4ht:inline--><!--l. 134--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mtable 
columnalign="left" class="align">
                                    <mtr><mtd 
columnalign="right" class="align-odd"><msub><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>ğœƒ</mi><mo 
class="MathClass-punc">,</mo><mi 
>Ï•</mi></mrow></msub 
></mtd>                                    <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-rel">âˆ¼</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-rel">âˆ¼</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><mo 
class="MathClass-open">(</mo><mn>1</mn> <mo 
class="MathClass-bin">âˆ’</mo><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo><mspace width="2em"/></mtd>                                    <mtd 
columnalign="right" class="align-label"></mtd>                                    <mtd 
class="align-label">
                                    <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>                                       <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo><mo  
> âˆ«
 <!--nolimits--></mo><!--nolimits--><mo 
class="MathClass-open">[</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">(</mo><mn>1</mn> <mo 
class="MathClass-bin">âˆ’</mo> <msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">]</mo><mi 
>d</mi><mi 
>x</mi><mspace width="2em"/></mtd>                                                                         <mtd 
columnalign="right" class="align-label"><mstyle 
   id="x1-2001r2"  class="label" ></mstyle><!--endlabel--><mstyle 
class="maketag"><mtext  >(2)</mtext></mstyle><mspace width="0.33em" class="nbsp" />
   </mtd></mtr></mtable></math>
<!--l. 135--><p class="noindent" >Let <!--l. 135--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>l</mi></mrow><mrow 
><mi 
>ğœƒ</mi><mo 
class="MathClass-punc">,</mo><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math> be the function under the
integral in (<a 
href="#x1-2001r2">2<!--tex4ht:ref: eq:pre-jsd --></a>). Assuming <!--l. 136--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
></math> is
ï¬‚exible and powerful enough, when <!--l. 136--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>ğœƒ</mi><mo 
class="MathClass-punc">,</mo><mi 
>Ï•</mi></mrow></msub 
></math>
is maximized with parameter <!--l. 137--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>Ï•</mi></mrow><mrow 
><mo 
class="MathClass-bin">âˆ—</mo></mrow></msup 
></math>,
<!--l. 137--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>l</mi></mrow><mrow 
><mi 
>ğœƒ</mi><mo 
class="MathClass-punc">,</mo><msup><mrow 
><mi 
>Ï•</mi></mrow><mrow 
><mo 
class="MathClass-bin">âˆ—</mo></mrow></msup 
></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math> is also maximized
everywhere. Take <!--l. 138--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>l</mi></mrow><mrow 
><mi 
>ğœƒ</mi><mo 
class="MathClass-punc">,</mo><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>â€™s
derivative against <!--l. 139--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>,
we have </p><table class="equation-star"><tr><td>
<!--l. 140--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                            <mfrac><mrow 
><mi 
>d</mi><msub><mrow 
><mi 
>l</mi></mrow><mrow 
><mi 
>ğœƒ</mi><mo 
class="MathClass-punc">,</mo><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow>
<mrow 
><mi 
>d</mi><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></mfrac> <mo 
class="MathClass-rel">=</mo>   <mfrac><mrow 
><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow> 
<mrow 
><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></mfrac> <mo 
class="MathClass-bin">âˆ’</mo>  <mfrac><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow> 
<mrow 
><mn>1</mn> <mo 
class="MathClass-bin">âˆ’</mo> <msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></mfrac>
</math></td></tr></table>
<!--l. 143--><p class="indent" >   Set the expression to 0, you derive <!--l. 143--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><msup><mrow 
><mi 
>Ï•</mi></mrow><mrow 
><mo 
class="MathClass-bin">âˆ—</mo></mrow></msup 
></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>:
</p><table class="equation"><tr><td> <a 
 id="x1-2002r3"></a>
<!--l. 144--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                                <msub><mrow 
><mi 
>D</mi></mrow><mrow 
><msup><mrow 
><mi 
>Ï•</mi></mrow><mrow 
><mo 
class="MathClass-bin">âˆ—</mo></mrow></msup 
></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo>      <mfrac><mrow 
><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow> 
<mrow 
><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></mfrac>
</math></td><td class="eq-no">(3)</td></tr></table>
<!--l. 147--><p class="indent" >   Substitute <!--l. 147--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>
with (<a 
href="#x1-2002r3">3<!--tex4ht:ref: eq:opti-d-theta --></a>) in (<a 
href="#x1-2001r2">2<!--tex4ht:ref: eq:pre-jsd --></a>), we have:

</p><!--tex4ht:inline--><!--l. 156--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mtable 
columnalign="left" class="align-star">
               <mtr><mtd 
columnalign="right" class="align-odd"><msub><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
></mtd>               <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>ğœƒ</mi><mo 
class="MathClass-punc">,</mo><msup><mrow 
><mi 
>Ï•</mi></mrow><mrow 
><mo 
class="MathClass-bin">âˆ—</mo></mrow></msup 
></mrow></msub 
><mspace width="2em"/></mtd>                                                                                           <mtd 
columnalign="right" class="align-label"></mtd>               <mtd 
class="align-label">
               <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>                 <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo><mo  
> âˆ«
 <!--nolimits--></mo><!--nolimits--><mo 
class="MathClass-open">[</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><msup><mrow 
><mi 
>Ï•</mi></mrow><mrow 
><mo 
class="MathClass-bin">âˆ—</mo></mrow></msup 
></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">(</mo><mn>1</mn> <mo 
class="MathClass-bin">âˆ’</mo> <msub><mrow 
><mi 
>D</mi></mrow><mrow 
><msup><mrow 
><mi 
>Ï•</mi></mrow><mrow 
><mo 
class="MathClass-bin">âˆ—</mo></mrow></msup 
></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">]</mo><mi 
>d</mi><mi 
>x</mi><mspace width="2em"/></mtd>                                                          <mtd 
columnalign="right" class="align-label"></mtd>               <mtd 
class="align-label">
               <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>                 <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo><mo  
> âˆ«
 <!--nolimits--></mo><!--nolimits--><mo 
class="MathClass-open">[</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits-->      <mfrac><mrow 
><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow> 
<mrow 
><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></mfrac> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits-->     <mfrac><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow> 
<mrow 
><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></mfrac><mo 
class="MathClass-close">]</mo><mi 
>d</mi><mi 
>x</mi><mspace width="2em"/></mtd>                                                     <mtd 
columnalign="right" class="align-label"></mtd>               <mtd 
class="align-label">
               <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>                 <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo><mo  
> âˆ«
 <!--nolimits--></mo><!--nolimits--><mo 
class="MathClass-open">[</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits-->       <mfrac><mrow 
><mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>2</mn></mrow></mfrac><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow> 
<mrow 
><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>2</mn></mrow></mfrac><mo 
class="MathClass-open">(</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo></mrow></mfrac> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits-->       <mfrac><mrow 
><mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>2</mn></mrow></mfrac><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow> 
<mrow 
><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>2</mn></mrow></mfrac><mo 
class="MathClass-open">(</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo></mrow></mfrac><mo 
class="MathClass-close">]</mo><mi 
>d</mi><mi 
>x</mi><mspace width="2em"/></mtd>                                               <mtd 
columnalign="right" class="align-label"></mtd>               <mtd 
class="align-label">
               <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>                 <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo><mo  
> âˆ«
 <!--nolimits--></mo><!--nolimits--><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits-->        <mfrac><mrow 
><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow> 
<mrow 
><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>2</mn></mrow></mfrac><mo 
class="MathClass-open">(</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo></mrow></mfrac><mi 
>d</mi><mi 
>x</mi> <mo 
class="MathClass-bin">+</mo><mo  
> âˆ«
 <!--nolimits--></mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits-->        <mfrac><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow> 
<mrow 
><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>2</mn></mrow></mfrac><mo 
class="MathClass-open">(</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo></mrow></mfrac><mi 
>d</mi><mi 
>x</mi> <mo 
class="MathClass-bin">âˆ’</mo><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mn>2</mn><mo  
>âˆ«
 <!--nolimits--></mo><!--nolimits--><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mi 
>d</mi><mi 
>x</mi> <mo 
class="MathClass-bin">âˆ’</mo><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mn>2</mn><mo  
>âˆ«
 <!--nolimits--></mo><!--nolimits--><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mi 
>d</mi><mi 
>x</mi><mspace width="2em"/></mtd>               <mtd 
columnalign="right" class="align-label"></mtd>               <mtd 
class="align-label">
               <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>                 <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo> <mi 
>D</mi><mi 
>L</mi><mo 
class="MathClass-open">[</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-punc">,</mo> <mfrac><mrow 
><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow> 
       <mrow 
><mn>2</mn></mrow></mfrac>        <mo 
class="MathClass-close">]</mo> <mo 
class="MathClass-bin">+</mo> <mi 
>D</mi><mi 
>L</mi><mo 
class="MathClass-open">[</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-punc">,</mo> <mfrac><mrow 
><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow> 
       <mrow 
><mn>2</mn></mrow></mfrac>        <mo 
class="MathClass-close">]</mo> <mo 
class="MathClass-bin">âˆ’</mo><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mn>4</mn><mspace width="2em"/></mtd>                                                <mtd 
columnalign="right" class="align-label"></mtd>               <mtd 
class="align-label">
   <mspace width="2em"/></mtd></mtr></mtable></math>
<!--l. 157--><p class="noindent" >The ï¬rst two terms is actually twice the Jenson-Shannon Divergence (JSD) deï¬ned as: </p><table class="equation-star"><tr><td>
<!--l. 159--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                    <mi 
>J</mi><mi 
>S</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>2</mn></mrow></mfrac><mo 
class="MathClass-open">[</mo><mi 
>D</mi><mi 
>L</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo> <mfrac><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></mrow> 
     <mrow 
><mn>2</mn></mrow></mfrac>    <mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <mi 
>D</mi><mi 
>L</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo> <mfrac><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></mrow> 
     <mrow 
><mn>2</mn></mrow></mfrac>    <mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">]</mo>
</math></td></tr></table>
<!--l. 162--><p class="indent" >   Using JSD, <!--l. 162--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
></math>
is further simpliï¬ed as: </p><table class="equation-star"><tr><td>
<!--l. 163--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                             <msub><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mn>2</mn><mi 
>J</mi><mi 
>S</mi><mo 
class="MathClass-open">(</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">âˆ’</mo><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mn>4</mn>
</math></td></tr></table>
<!--l. 166--><p class="indent" >   Now it becomes clear that the generator <!--l. 166--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
></math> is
really optimizing the J-S divergence between <!--l. 167--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>
and <!--l. 167--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math> given the
optimal <!--l. 168--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi><mo 
class="MathClass-bin">âˆ—</mo></mrow></msub 
></math>.
</p><!--l. 170--><p class="indent" >   The Jenson-Shannon Divergence has a few properties as well. </p>
     <ul class="itemize1">
     <li class="itemize"><!--l. 172--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>J</mi><mi 
>S</mi><mi 
>D</mi><mo 
class="MathClass-open">(</mo><mi 
>p</mi><mo 
class="MathClass-punc">,</mo><mi 
>q</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">â‰¥</mo> <mn>0</mn></math>
     </li>
     <li class="itemize"><!--l. 173--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>J</mi><mi 
>S</mi><mi 
>D</mi><mo 
class="MathClass-open">(</mo><mi 
>p</mi><mo 
class="MathClass-punc">,</mo><mi 
>q</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">â‰¥</mo> <mn>0</mn></math>
     iï¬€ <!--l. 173--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>q</mi></math>
     </li>
     <li class="itemize">Unlike the K-L divergence, <!--l. 174--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>J</mi><mi 
>S</mi><mi 
>D</mi><mo 
class="MathClass-open">(</mo><mi 
>p</mi><mo 
class="MathClass-punc">,</mo><mi 
>q</mi><mo 
class="MathClass-close">)</mo></math>
     is symmetric. That is <!--l. 174--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>J</mi><mi 
>S</mi><mi 
>D</mi><mo 
class="MathClass-open">(</mo><mi 
>p</mi><mo 
class="MathClass-punc">,</mo><mi 
>q</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo> <mi 
>J</mi><mi 
>S</mi><mi 
>D</mi><mo 
class="MathClass-open">(</mo><mi 
>q</mi><mo 
class="MathClass-punc">,</mo><mi 
>p</mi><mo 
class="MathClass-close">)</mo></math>.</li></ul>
<!--l. 177--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">1.2   </span> <a 
 id="x1-30001.2"></a>Contrast Maximization</h4>
<!--l. 179--><p class="noindent" >When <!--l. 179--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
></math> is trained reasonably well, which
means <!--l. 179--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math> is close to 1 for real samples, and
is close to 0 for artiï¬cal samples, <!--l. 181--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>ğœƒ</mi><mo 
class="MathClass-punc">,</mo><mi 
>Ï•</mi></mrow></msub 
></math>can
be shown to maximize the contrast of <!--l. 181--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>
between real and artiï¬cal samples, as shown below.
</p><!--tex4ht:inline--><!--l. 187--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mtable 
columnalign="left" class="align">
                                    <mtr><mtd 
columnalign="right" class="align-odd"><msub><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>ğœƒ</mi><mo 
class="MathClass-punc">,</mo><mi 
>Ï•</mi></mrow></msub 
></mtd>                                    <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-rel">âˆ¼</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-rel">âˆ¼</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><mo 
class="MathClass-open">(</mo><mn>1</mn> <mo 
class="MathClass-bin">âˆ’</mo><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo><mspace width="2em"/></mtd>                                    <mtd 
columnalign="right" class="align-label"></mtd>                                    <mtd 
class="align-label">
                                    <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>                                       <mtd 
class="align-even"> <mo 
class="MathClass-rel">â‰ƒ</mo> <msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-rel">âˆ¼</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">âˆ’</mo> <mn>1</mn><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-rel">âˆ¼</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
> <mo 
class="MathClass-bin">âˆ’</mo> <msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mspace width="2em"/></mtd>                                                                            <mtd 
columnalign="right" class="align-label"><mstyle 
   id="x1-3001r4"  class="label" ></mstyle><!--endlabel--><mstyle 
class="maketag"><mtext  >(4)</mtext></mstyle><mspace width="0.33em" class="nbsp" />
                                    </mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>                                       <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-rel">âˆ¼</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">âˆ’</mo> <msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-rel">âˆ¼</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">âˆ’</mo> <mn>1</mn><mspace width="2em"/></mtd>                                           <mtd 
columnalign="right" class="align-label"></mtd>                                    <mtd 
class="align-label">
   <mspace width="2em"/></mtd></mtr></mtable></math>
<!--l. 188--><p class="noindent" >(<a 
href="#x1-3001r4">4<!--tex4ht:ref: eq:contrast-approx --></a>) uses the ï¬rst derivative of <!--l. 188--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">(</mo><mo 
class="MathClass-bin">â‹…</mo><mo 
class="MathClass-close">)</mo></math>
at <!--l. 189--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi class="qopname"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo><!--nolimits--><mo 
class="MathClass-open">(</mo><mn>1</mn><mo 
class="MathClass-close">)</mo></math> for approximation.
Of course, when <!--l. 189--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
></math>
is not a very good discriminator yet, the above does not hold.
</p><!--l. 192--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">2   </span> <a 
 id="x1-40002"></a>f-GAN</h3>
<!--l. 194--><p class="noindent" >too much math and too little practical impact to write about... will pick up later
</p><!--l. 197--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">3   </span> <a 
 id="x1-50003"></a>WGAN</h3>
<!--l. 199--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.1   </span> <a 
 id="x1-60003.1"></a>Problems with GAN</h4>
<!--l. 201--><p class="noindent" >GAN is known to generate very impressive photorealistic images, but it also has a few well documented drawbacks.
</p><!--l. 204--><p class="indent" >   The ï¬rst is a problem known as mode collapse. The discriminator
<!--l. 204--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
></math>
only cares about distinguishing real samples from artiï¬cial samples. It does not care about whether those artiï¬cial samples have
broad coverage or not. For example, suppose the real samples include images of diï¬€erent animals such as cats, dogs, and horses.
<!--l. 208--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
></math>
is happy to generate pictures of only dogs as long as these pictures become more real each time
<!--l. 210--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>ğœƒ</mi></math> is updated.
<!--l. 210--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
></math> is also perfectly
happy with <!--l. 211--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
></math>â€™s behavior
as long as each time <!--l. 212--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Ï•</mi></math> is
updated, <!--l. 212--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
></math>
can tell real animal pictures from these artiï¬cal dog picutres a little better.
</p><!--l. 215--><p class="indent" >   The second notorious problem with GAN is its diï¬ƒculty to train. Unlike other deep learning problems which see their loss function decreases
gradually until converging to 0 in training, GANâ€™s minimax objective does not oï¬€er any such guarantee. In practice, GANâ€™s objective keeps
oscillating during training. Deciding when to stop training is often a manual process. Another reason that prevents GANâ€™s eï¬€ective training has to do
with <!--l. 221--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
></math>â€™s
ï¬nal activation function, typically sigmoid. When real samples and artiï¬cial samples are far apart, it is easy for
<!--l. 223--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
></math> to
distinguish them. In this case, sigmoidâ€™s outputs are very close to 1 for real samples, and 0 for artiï¬cial samples. Its derivative is
very close to 0, a problem known as vanishing gradient. These 0 gradients cannot provide eï¬€ective back-propagation for
<!--l. 227--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
></math> to improve
its sample generating process.
</p><!--l. 229--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.2   </span> <a 
 id="x1-70003.2"></a>Intuition of WGAN</h4>
<!--l. 231--><p class="noindent" >The inspiration of Wasserstein GAN (WGAN) comes from contrast maximization described in Section <a 
href="#x1-30001.2">1.2<!--tex4ht:ref: subsec:Contrast-Maximization --></a> and sigmoidâ€™s vanishing gradient problem
described in Section <a 
href="#x1-60003.1">3.1<!--tex4ht:ref: subsec:Problems-with-GAN --></a>. WGANâ€™s objective is </p><table class="equation-star"><tr><td>
<!--l. 235--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                               <munder class="msub"><mrow 
><mi class="qopname">min</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></munder 
><munder class="msub"><mrow 
><mi class="qopname"> max</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
><mi 
>Ï•</mi></mrow></munder 
><msub><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>ğœƒ</mi><mo 
class="MathClass-punc">,</mo><mi 
>Ï•</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo><munder class="msub"><mrow 
><mi class="qopname"> min</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></munder 
><munder class="msub"><mrow 
><mi class="qopname"> max</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
><mi 
>Ï•</mi></mrow></munder 
><mo 
class="MathClass-open">[</mo><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-rel">âˆ¼</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">âˆ’</mo> <msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-rel">âˆ¼</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">]</mo>
</math></td></tr></table>
<!--l. 238--><p class="indent" >   Basically, <!--l. 238--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
></math>
tries to maximize its output for real samples and minimize its output for artiï¬cial samples.
<!--l. 239--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
></math> on the
other hand tries to generate artiï¬cal samples that also get large outputs.
</p><!--l. 243--><p class="indent" >   This objective looks just like the contrast maximization loss in Section (<a 
href="#x1-30001.2">1.2<!--tex4ht:ref: subsec:Contrast-Maximization --></a>), but there are two main
diï¬€erences: it is no longer an approximation in a narrow range and sigmoid is not used to compress
<!--l. 246--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
></math>â€™s output to between 0 and 1. Completely
removing <!--l. 247--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
></math>â€™s output value constraint
may, however, pose another problem; <!--l. 248--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>ğœƒ</mi><mo 
class="MathClass-punc">,</mo><mi 
>Ï•</mi></mrow></msub 
></math>
may grow very rapidly out of bound and may still take the form of a sigmoid function and stiï¬‚e back-propagation. Ideally, weâ€™d like
<!--l. 250--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
></math> to behave roughly like
a linear function of <!--l. 251--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>.
Given deep neural networks are diï¬€erentiable for almost all input, we could force the norm of
<!--l. 252--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
></math>â€™s gradient
to be close to 1 everywhere: </p><table class="equation-star"><tr><td>
<!--l. 254--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                                    <mrow><mo fence="true" form="prefix"> âˆ¥</mo><mrow><msub><mrow 
><mi 
class="MathClass-op">âˆ‡</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo></mrow><mrow 
><mi 
>x</mi></mrow></msub 
><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow><mo fence="true" form="postfix">âˆ¥</mo></mrow> <mo 
class="MathClass-rel">â‰ƒ</mo> <mn>1</mn>
</math></td></tr></table>
<!--l. 257--><p class="indent" >   This constraint can be added to <!--l. 257--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>ğœƒ</mi><mo 
class="MathClass-punc">,</mo><mi 
>Ï•</mi></mrow></msub 
></math>
as a penalty term: </p><table class="equation-star"><tr><td>

<!--l. 258--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                                   <msup><mrow 
><mo 
class="MathClass-open">(</mo><mrow><mo fence="true" form="prefix"> âˆ¥</mo><mrow><msub><mrow 
><mi 
class="MathClass-op">âˆ‡</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo></mrow><mrow 
><mi 
>x</mi></mrow></msub 
><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow><mo fence="true" form="postfix">âˆ¥</mo></mrow> <mo 
class="MathClass-bin">âˆ’</mo> <mn>1</mn><mo 
class="MathClass-close">)</mo></mrow><mrow 
><mn>2</mn></mrow></msup 
>
</math></td></tr></table>
<!--l. 261--><p class="indent" >   This penalty term needs to be numerically computable. Averaging over all possible value of
<!--l. 262--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>
is out of the question, but one possbility is to average it over both the real samples and the artiï¬cial samples, as shown below:
</p><table class="equation-star"><tr><td>
<!--l. 265--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                 <msub><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>ğœƒ</mi><mo 
class="MathClass-punc">,</mo><mi 
>Ï•</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-rel">âˆ¼</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">âˆ’</mo> <msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-rel">âˆ¼</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">âˆ’</mo> <mi 
>Î»</mi><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-rel">âˆ¼</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><msup><mrow 
><mo 
class="MathClass-open">(</mo><mrow><mo fence="true" form="prefix"> âˆ¥</mo><mrow><msub><mrow 
><mi 
class="MathClass-op">âˆ‡</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo></mrow><mrow 
><mi 
>x</mi></mrow></msub 
><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow><mo fence="true" form="postfix">âˆ¥</mo></mrow> <mo 
class="MathClass-bin">âˆ’</mo> <mn>1</mn><mo 
class="MathClass-close">)</mo></mrow><mrow 
><mn>2</mn></mrow></msup 
> <mo 
class="MathClass-bin">âˆ’</mo> <mi 
>Î»</mi><msub><mrow 
><mi 
>E</mi></mrow><mrow 
>
<mi 
>x</mi><mo 
class="MathClass-rel">âˆ¼</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><msup><mrow 
><mo 
class="MathClass-open">(</mo><mrow><mo fence="true" form="prefix"> âˆ¥</mo><mrow><msub><mrow 
><mi 
class="MathClass-op">âˆ‡</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo></mrow><mrow 
><mi 
>x</mi></mrow></msub 
><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow><mo fence="true" form="postfix">âˆ¥</mo></mrow> <mo 
class="MathClass-bin">âˆ’</mo> <mn>1</mn><mo 
class="MathClass-close">)</mo></mrow><mrow 
><mn>2</mn></mrow></msup 
>
</math></td></tr></table>
<!--l. 268--><p class="indent" >   where <!--l. 268--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Î»</mi></math>
is the knob adjusting the relative importance between maximizing contrast and making
<!--l. 269--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
></math> roughly a
linear function.
</p><!--l. 271--><p class="indent" >   A variant of the above formulation creates samples by randomly and linearly interpolating between real and artiï¬cial samples, and averages the
penalty term over these samples instead. The ï¬nal objective function, expressed in numerical computation form, is the following:
</p><table class="equation-star"><tr><td>
<!--l. 275--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                      <msub><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>ğœƒ</mi><mo 
class="MathClass-punc">,</mo><mi 
>Ï•</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo>  <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mi 
>N</mi></mrow></mfrac><munder class="msub"><mrow 
><mo  
>âˆ‘</mo>
   </mrow><mrow 
><mi 
>i</mi></mrow></munder 
><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>áº‹</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">âˆ’</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mi 
>N</mi></mrow></mfrac><munder class="msub"><mrow 
><mo  
>âˆ‘</mo>
   </mrow><mrow 
><mi 
>i</mi></mrow></munder 
><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mover 
accent="true"><mrow 
><mi 
>x</mi></mrow><mo accent="true">~</mo></mover></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">âˆ’</mo> <mfrac><mrow 
><mi 
>Î»</mi></mrow> 
<mrow 
><mi 
>N</mi></mrow></mfrac><munder class="msub"><mrow 
><mo  
>âˆ‘</mo>
   </mrow><mrow 
><mi 
>i</mi></mrow></munder 
><msup><mrow 
><mo 
class="MathClass-open">(</mo><mrow><mo fence="true" form="prefix"> âˆ¥</mo><mrow><msub><mrow 
><mi 
class="MathClass-op">âˆ‡</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo></mrow><mrow 
><mi 
>x</mi></mrow></msub 
><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">[</mo><msub><mrow 
><mi 
>ğœ€</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><msub><mrow 
><mi 
>áº‹</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <mo 
class="MathClass-open">(</mo><mn>1</mn> <mo 
class="MathClass-bin">âˆ’</mo> <msub><mrow 
><mi 
>ğœ€</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><msub><mrow 
><mover 
accent="true"><mrow 
><mi 
>x</mi></mrow><mo accent="true">~</mo></mover></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">]</mo></mrow><mo fence="true" form="postfix">âˆ¥</mo></mrow> <mo 
class="MathClass-bin">âˆ’</mo> <mn>1</mn><mo 
class="MathClass-close">)</mo></mrow><mrow 
><mn>2</mn></mrow></msup 
>
</math></td></tr></table>
<!--l. 278--><p class="indent" >   where <!--l. 278--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>ğœ€</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">âˆ¼</mo> <mi 
>U</mi><mo 
class="MathClass-open">(</mo><mn>0</mn><mo 
class="MathClass-punc">,</mo><mn>1</mn><mo 
class="MathClass-close">)</mo></math>.
GAN with this gradient norm penalty is called Wasserstein Generative Adversarial Network - Gradient Penalty (WGAN-GP).
</p><!--l. 282--><p class="indent" >   Both <!--l. 282--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
></math>
and <!--l. 282--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
></math> aï¬€ects
the penalty term. Though it is not mentioned in the original WGAN-GP paper, I donâ€™t think it is desirable to add the penalty term to
<!--l. 284--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
></math>â€™s loss
function. WGAN-GPâ€™s objective should instead be
</p><!--tex4ht:inline--><!--l. 289--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mtable 
columnalign="left" class="align-star">
                         <mtr><mtd 
columnalign="right" class="align-odd"></mtd>                         <mtd 
class="align-even"><munder class="msub"><mrow 
><mi class="qopname"> max</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
><mi 
>Ï•</mi></mrow></munder 
><mo 
class="MathClass-open">[</mo> <mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mi 
>N</mi></mrow></mfrac><munder class="msub"><mrow 
><mo  
>âˆ‘</mo>
   </mrow><mrow 
><mi 
>i</mi></mrow></munder 
><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>áº‹</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">âˆ’</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mi 
>N</mi></mrow></mfrac><munder class="msub"><mrow 
><mo  
>âˆ‘</mo>
   </mrow><mrow 
><mi 
>i</mi></mrow></munder 
><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mover 
accent="true"><mrow 
><mi 
>x</mi></mrow><mo accent="true">~</mo></mover></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">âˆ’</mo> <mfrac><mrow 
><mi 
>Î»</mi></mrow> 
<mrow 
><mi 
>N</mi></mrow></mfrac><munder class="msub"><mrow 
><mo  
>âˆ‘</mo>
   </mrow><mrow 
><mi 
>i</mi></mrow></munder 
><msup><mrow 
><mo 
class="MathClass-open">(</mo><mrow><mo fence="true" form="prefix"> âˆ¥</mo><mrow><msub><mrow 
><mi 
class="MathClass-op">âˆ‡</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo></mrow><mrow 
><mi 
>x</mi></mrow></msub 
><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">[</mo><msub><mrow 
><mi 
>ğœ€</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><msub><mrow 
><mi 
>áº‹</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <mo 
class="MathClass-open">(</mo><mn>1</mn> <mo 
class="MathClass-bin">âˆ’</mo> <msub><mrow 
><mi 
>ğœ€</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo><msub><mrow 
><mover 
accent="true"><mrow 
><mi 
>x</mi></mrow><mo accent="true">~</mo></mover></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">]</mo></mrow><mo fence="true" form="postfix">âˆ¥</mo></mrow> <mo 
class="MathClass-bin">âˆ’</mo> <mn>1</mn><mo 
class="MathClass-close">)</mo></mrow><mrow 
><mn>2</mn></mrow></msup 
><mo 
class="MathClass-close">]</mo><mspace width="2em"/></mtd>                         <mtd 
columnalign="right" class="align-label"></mtd>                         <mtd 
class="align-label">
                         <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>                         <mtd 
class="align-even"><munder class="msub"><mrow 
><mi class="qopname">min</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></munder 
><mo 
class="MathClass-open">[</mo> <mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mi 
>N</mi></mrow></mfrac><munder class="msub"><mrow 
><mo  
>âˆ‘</mo>
   </mrow><mrow 
><mi 
>i</mi></mrow></munder 
><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>áº‹</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">âˆ’</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mi 
>N</mi></mrow></mfrac><munder class="msub"><mrow 
><mo  
>âˆ‘</mo>
   </mrow><mrow 
><mi 
>i</mi></mrow></munder 
><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mover 
accent="true"><mrow 
><mi 
>x</mi></mrow><mo accent="true">~</mo></mover></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">]</mo><mspace width="2em"/></mtd>                                                              <mtd 
columnalign="right" class="align-label"></mtd>                         <mtd 
class="align-label">
   <mspace width="2em"/></mtd></mtr></mtable></math>
<!--l. 291--><p class="noindent" >There are a couple more things worth noting. </p>
     <ul class="itemize1">
     <li class="itemize"><!--l. 293--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
class="MathClass-op">âˆ‡</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo></mrow><mrow 
><mi 
>x</mi></mrow></msub 
><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>
     is the derivative against <!--l. 293--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>,
     not against <!--l. 294--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Ï•</mi></math>.
     What is used in back-propagation to update <!--l. 294--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Ï•</mi></math>
     includes <!--l. 295--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mo 
class="MathClass-open">(</mo><mrow><mo fence="true" form="prefix"> âˆ¥</mo><mrow><msub><mrow 
><mi 
class="MathClass-op">âˆ‡</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo></mrow><mrow 
><mi 
>x</mi></mrow></msub 
><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow><mo fence="true" form="postfix">âˆ¥</mo></mrow> <mo 
class="MathClass-bin">âˆ’</mo> <mn>1</mn><mo 
class="MathClass-close">)</mo></mrow><mrow 
><mn>2</mn></mrow></msup 
></math>â€™s
     derivative against <!--l. 296--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Ï•</mi></math>.
     </li>
     <li class="itemize">Obviously, with WGAN, <!--l. 297--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
></math>
     no longer minimizes the Jenson-Shannon divergence even given an optimal <!--l. 298--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><msup><mrow 
><mi 
>Ï•</mi></mrow><mrow 
><mo 
class="MathClass-bin">âˆ—</mo></mrow></msup 
></mrow></msub 
></math>.</li></ul>
<!--l. 301--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.3   </span> <a 
 id="x1-80003.3"></a>Math of WGAN</h4>
<!--l. 303--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">3.3.1   </span> <a 
 id="x1-90003.3.1"></a>Inï¬mum and supremum</h5>
<!--l. 305--><p class="noindent" >Most people are familiar with the concept of maximum and minimum. Explicitly, if
<!--l. 306--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>X</mi></math> is a (partially)
ordered set and <!--l. 306--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>S</mi></math>
a subset, then <!--l. 307--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>s</mi></mrow><mo accent="true">Â¯</mo></mover></math> is
the maximum of <!--l. 307--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>S</mi></math>
iï¬€ <!--l. 307--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>s</mi></mrow><mo accent="true">Â¯</mo></mover> <mo 
class="MathClass-rel">âˆˆ</mo> <mi 
>S</mi></math> and
<!--l. 307--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi> <mo 
class="MathClass-rel">â‰¤</mo><mover 
accent="true"><mrow 
><mi 
>s</mi></mrow><mo accent="true">Â¯</mo></mover></math> for all
<!--l. 308--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi> <mo 
class="MathClass-rel">âˆˆ</mo> <mi 
>S</mi></math>. Similarly,
<!--l. 308--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><munder accentunder="false" 
class="mml-underline"><mrow><mi 
>s</mi></mrow><mo 
accent="true">Ì²</mo></munder></math> is the minimum
of <!--l. 308--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>S</mi></math> iï¬€
<!--l. 309--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><munder accentunder="false" 
class="mml-underline"><mrow><mi 
>s</mi></mrow><mo 
accent="true">Ì²</mo></munder> <mo 
class="MathClass-rel">âˆˆ</mo> <mi 
>S</mi></math> and
<!--l. 309--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi> <mo 
class="MathClass-rel">â‰¥</mo><munder accentunder="false" 
class="mml-underline"><mrow><mi 
>s</mi></mrow><mo 
accent="true">Ì²</mo></munder></math> for all
<!--l. 309--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi> <mo 
class="MathClass-rel">âˆˆ</mo> <mi 
>S</mi></math>.
</p><!--l. 311--><p class="indent" >   The supremum (sup) of <!--l. 311--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>S</mi></math> can be deï¬ned
like this. Let <!--l. 311--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>T</mi> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-open">{</mo><mi 
>t</mi> <mo 
class="MathClass-rel">âˆˆ</mo> <mi 
>X</mi><mo 
class="MathClass-rel">|</mo><mi 
>s</mi> <mo 
class="MathClass-rel">â‰¤</mo> <mi 
>t</mi><mspace width="0.17em" class="thinspace"/><mi 
class="MathClass-op">âˆ€</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo><mi 
>s</mi> <mo 
class="MathClass-rel">âˆˆ</mo> <mi 
>S</mi><mo 
class="MathClass-close">}</mo></math>, which deï¬nes the set of
elements greater than all members of <!--l. 312--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>S</mi></math>.
If <!--l. 313--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>T</mi></math> is empty,
<!--l. 313--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>S</mi></math>â€™s supremum does not exist, otherwise
it is the mininum of <!--l. 314--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>T</mi></math>. If S has a
maximum, it must be the same as <!--l. 314--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>S</mi></math>â€™s
supremum. Even if <!--l. 315--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>S</mi></math>
does not have a maximum, it may still have a supremum. Below are three examples comparing maximum and supremum.
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-9002x1"><!--l. 318--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>S</mi> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-open">{</mo><mi 
>x</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi> <mo 
class="MathClass-rel">â‰¤</mo> <mn>2</mn><mo 
class="MathClass-close">}</mo></math>:
     <!--l. 318--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>S</mi></math>â€™s
     maximum is 2, and its supremum is 2 as well.
     </li>
     <li 
  class="enumerate" id="x1-9004x2"><!--l. 319--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>S</mi> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-open">{</mo><mi 
>x</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi> <mo 
class="MathClass-rel">&#x003C;</mo> <mn>2</mn><mo 
class="MathClass-close">}</mo></math>:
     <!--l. 319--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>S</mi></math>
     does not have a maximum, but its supremum is 2.
     </li>
     <li 
  class="enumerate" id="x1-9006x3"><!--l. 321--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>S</mi> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-open">{</mo><mi 
>x</mi><mo 
class="MathClass-rel">|</mo><mi 
>x</mi> <mo 
class="MathClass-rel">&#x003E;</mo> <mn>2</mn><mo 
class="MathClass-close">}</mo></math>:
     <!--l. 321--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>S</mi></math>
     has neither a maximum nor a supremum.</li></ol>
<!--l. 323--><p class="noindent" >Similar comparisons can be made between minimum and inï¬mum. Informally, if one uses supremum and maximum interexchangeably, little is lost. The
same goes for inï¬mum and minimum.
</p><!--l. 327--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">3.3.2   </span> <a 
 id="x1-100003.3.2"></a>Wasserstein Distance</h5>
<!--l. 329--><p class="noindent" >K-L divergence and J-S divergence are often used to measure the closeness between two distributions. In fact, VAE (<a 
href="amaires.github.io/VAE" class="url" ><span 
class="ectt-1000">amaires.github.io/VAE</span></a>) uses K-L divergence for
optimization and GANâ€™s <!--l. 331--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
></math> minimizes
the J-S divergence given an optimal <!--l. 332--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><msup><mrow 
><mi 
>Ï•</mi></mrow><mrow 
><mo 
class="MathClass-bin">âˆ—</mo></mrow></msup 
></mrow></msub 
></math>.
Unfortunately, these two measures have discontinuity when two distributions have disjoint supports (the support of a function is the subset of the
function domain not mapped to 0). For example, given two distributions deï¬ned below: </p><table class="equation-star"><tr><td>
<!--l. 337--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
<mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo>  <mrow><mo fence="true" form="prefix"> {</mo><mrow> <mtable  align="axis" style=""  
equalrows="false" columnlines="none" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="left"><mn>1</mn><mspace width="1em" class="quad"/></mtd><mtd 
class="array"  columnalign="left"><mi 
>x</mi> <mo 
class="MathClass-rel">=</mo> <mn>0</mn></mtd></mtr>  <mtr><mtd 
class="array"  columnalign="left"><mn>0</mn><mspace width="1em" class="quad"/></mtd> <mtd 
class="array"  columnalign="left"><mi 
>x</mi><mo 
class="MathClass-rel">â‰ </mo> <mn>0</mn></mtd></mtr> <!--@{}l@{\quad }l@{}--></mtable>                                                                                                                                                                           </mrow><mo fence="true" form="postfix"></mo></mrow><mspace width="0.17em" class="thinspace"/><mspace width="0.17em" class="thinspace"/><mstyle mathvariant="normal"><mi 
>a</mi><mi 
>n</mi><mi 
>d</mi></mstyle><mspace width="0.17em" class="thinspace"/><mspace width="0.17em" class="thinspace"/><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo>  <mrow><mo fence="true" form="prefix"> {</mo><mrow> <mtable  align="axis" style=""  
equalrows="false" columnlines="none" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="left"><mn>1</mn><mspace width="1em" class="quad"/></mtd><mtd 
class="array"  columnalign="left"><mi 
>x</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>ğœƒ</mi></mtd></mtr>  <mtr><mtd 
class="array"  columnalign="left"><mn>0</mn><mspace width="1em" class="quad"/></mtd> <mtd 
class="array"  columnalign="left"><mi 
>x</mi><mo 
class="MathClass-rel">â‰ </mo> <mi 
>ğœƒ</mi></mtd></mtr> <!--@{}l@{\quad }l@{}--></mtable>                                                                                                                                                 </mrow><mo fence="true" form="postfix"></mo></mrow>
</math></td></tr></table>
<!--l. 346--><p class="indent" >   It is not hard to ï¬gure out their K-L and J-S divergence: </p><table class="equation-star"><tr><td>
<!--l. 347--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
<mi 
>K</mi><mi 
>L</mi><mo 
class="MathClass-open">(</mo><mi 
>p</mi><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo>  <mrow><mo fence="true" form="prefix"> {</mo><mrow> <mtable  align="axis" style=""  
equalrows="false" columnlines="none" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="left"><mn>0</mn> <mspace width="1em" class="quad"/></mtd><mtd 
class="array"  columnalign="left"><mi 
>ğœƒ</mi> <mo 
class="MathClass-rel">=</mo> <mn>0</mn></mtd></mtr>  <mtr><mtd 
class="array"  columnalign="left"><mi 
>âˆ</mi><mspace width="1em" class="quad"/></mtd> <mtd 
class="array"  columnalign="left"><mi 
>ğœƒ</mi><mo 
class="MathClass-rel">â‰ </mo> <mn>0</mn></mtd></mtr> <!--@{}l@{\quad }l@{}--></mtable>                                                                                                                                                                         </mrow><mo fence="true" form="postfix"></mo></mrow><mspace width="0.17em" class="thinspace"/><mspace width="0.17em" class="thinspace"/><mstyle mathvariant="normal"><mi 
>a</mi><mi 
>n</mi><mi 
>d</mi></mstyle><mspace width="0.17em" class="thinspace"/><mspace width="0.17em" class="thinspace"/><mi 
>J</mi><mi 
>S</mi><mo 
class="MathClass-open">(</mo><mi 
>p</mi><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo>  <mrow><mo fence="true" form="prefix"> {</mo><mrow> <mtable  align="axis" style=""  
equalrows="false" columnlines="none" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="left"><mn>0</mn>    <mspace width="1em" class="quad"/></mtd><mtd 
class="array"  columnalign="left"><mi 
>ğœƒ</mi> <mo 
class="MathClass-rel">=</mo> <mn>0</mn></mtd></mtr>  <mtr><mtd 
class="array"  columnalign="left"><mi class="qopname">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo> <!--nolimits--> <mn>2</mn><mspace width="1em" class="quad"/></mtd> <mtd 
class="array"  columnalign="left"><mi 
>ğœƒ</mi><mo 
class="MathClass-rel">â‰ </mo> <mn>0</mn></mtd></mtr> <!--@{}l@{\quad }l@{}--></mtable>                                                                                                                                                                      </mrow><mo fence="true" form="postfix"></mo></mrow>
</math></td></tr></table>
<!--l. 357--><p class="indent" >   Ideally, weâ€™d like a measure that is smoother. Wasserstein distance is exactly such a function deï¬ned as: </p><table class="equation-star"><tr><td>
<!--l. 359--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                       <mi 
>W</mi><mi 
>S</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo><munder class="msub"><mrow 
><mi class="qopname"> inf</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo> </mrow><mrow 
><mi 
>Î³</mi><mo 
class="MathClass-rel">âˆˆ</mo><mo  
>âˆ</mo><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-close">)</mo></mrow></munder 
><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-rel">âˆ¼</mo><mi 
>Î³</mi></mrow></msub 
><msub><mrow 
> <mrow><mo fence="true" form="prefix"> âˆ¥</mo><mrow><mi 
>x</mi> <mo 
class="MathClass-bin">âˆ’</mo> <mi 
>y</mi></mrow><mo fence="true" form="postfix">âˆ¥</mo></mrow></mrow><mrow 
><mn>1</mn></mrow></msub 
>
</math></td></tr></table>
<!--l. 362--><p class="indent" >   where <!--l. 362--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
class="MathClass-op"> âˆ</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo>
  <!--nolimits--><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-close">)</mo></math> contains all
joint distribution of <!--l. 362--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo></math>
such that <!--l. 363--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo><mi 
class="MathClass-op"> âˆ«
 <!--nolimits--></mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo><!--nolimits--><mi 
>Î³</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo><mi 
>d</mi><mi 
>y</mi></math>
and <!--l. 363--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo><mi 
class="MathClass-op"> âˆ«
 <!--nolimits--></mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo><!--nolimits--><mi 
>Î³</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo><mi 
>d</mi><mi 
>x</mi></math>.
Wasserstein distance is also called earth-mover distance. It informally captures the minimal amount of mass/dirt needs to be moved to turn the shape
of <!--l. 366--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></math> into that of
<!--l. 366--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></math>. Using this deï¬nition, the
Wasserstain distance between <!--l. 367--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>
and <!--l. 367--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math> above can be
calculated to be <!--l. 368--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-rel">|</mo><mi 
>ğœƒ</mi><mo 
class="MathClass-rel">|</mo></math>, which is
a continuous function of <!--l. 369--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>ğœƒ</mi></math>.
</p><!--l. 371--><p class="indent" >   In general, however, Wasserstein distance is intractable to calculate. Fortunately, Wasserstein distance has another deï¬nition, based on the
Kantorovich-Rubinstein duality, which is easier to handle: </p><table class="equation"><tr><td> <a 
 id="x1-10001r5"></a>
<!--l. 374--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                      <mi 
>W</mi><mi 
>S</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo><munder class="msub"><mrow 
><mi class="qopname"> sup</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--> </mo></mrow><mrow 
><msub><mrow 
><mrow><mo fence="true" form="prefix"> âˆ¥</mo><mrow><mi 
>f</mi> </mrow><mo fence="true" form="postfix">âˆ¥</mo></mrow></mrow><mrow 
><mi 
>L</mi></mrow></msub 
><mo 
class="MathClass-rel">â‰¤</mo><mn>1</mn></mrow></munder 
><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-rel">âˆ¼</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></mrow></msub 
><mi 
>f</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">âˆ’</mo> <msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-rel">âˆ¼</mo><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></mrow></msub 
><mi 
>f</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo>
</math></td><td class="eq-no">(5)</td></tr></table>
<!--l. 377--><p class="indent" >   where <!--l. 377--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>f</mi><mo 
class="MathClass-open">(</mo><mo 
class="MathClass-bin">â‹…</mo><mo 
class="MathClass-close">)</mo></math> is any real
valued function. <!--l. 377--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
> <mrow><mo fence="true" form="prefix"> âˆ¥</mo><mrow><mi 
>f</mi> </mrow><mo fence="true" form="postfix">âˆ¥</mo></mrow></mrow><mrow 
><mi 
>L</mi></mrow></msub 
> <mo 
class="MathClass-rel">â‰¤</mo> <mn>1</mn></math>
means <!--l. 378--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>f</mi></math>â€™s
Lipschitz constant is 1. Technically, it means </p><table class="equation-star"><tr><td>
<!--l. 379--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                              <mo 
class="MathClass-rel">|</mo><mi 
>f</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">âˆ’</mo> <mi 
>f</mi><mo 
class="MathClass-open">(</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-rel">|</mo><mo 
class="MathClass-rel">â‰¤</mo><msub><mrow 
> <mrow><mo fence="true" form="prefix"> âˆ¥</mo><mrow><mi 
>x</mi> <mo 
class="MathClass-bin">âˆ’</mo> <mi 
>y</mi></mrow><mo fence="true" form="postfix">âˆ¥</mo></mrow></mrow><mrow 
><mn>1</mn></mrow></msub 
><mspace width="0.17em" class="thinspace"/><mi 
class="MathClass-op">âˆ€</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi>
</math></td></tr></table>
<!--l. 382--><p class="indent" >   Intuitively, it is equivalent to saying <!--l. 382--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>f</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>â€™s
value should not change too much as <!--l. 383--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>
changes.
</p><!--l. 385--><p class="indent" >   Wasserstein distance (<a 
href="#x1-10001r5">5<!--tex4ht:ref: eq:duality --></a>) really captures the contrast maximization idea in Section <a 
href="#x1-30001.2">1.2<!--tex4ht:ref: subsec:Contrast-Maximization --></a> well. The Lipschitz continuity constraint can be
approximated by the gradient penalty term introduced in <a 
href="#x1-70003.2">3.2<!--tex4ht:ref: subsec:Intuition-of-WGAN --></a>.
</p><!--l. 390--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">3.3.3   </span> <a 
 id="x1-110003.3.3"></a>GAN and WGAN</h5>
<!--l. 392--><p class="noindent" >GANâ€™s <!--l. 392--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
></math> optimizes maximum
likelihood of observing samples <!--l. 393--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>áº‹</mi></math>
and <!--l. 393--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>x</mi></mrow><mo accent="true">~</mo></mover></math>. Given an
optional <!--l. 393--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><msup><mrow 
><mi 
>Ï•</mi></mrow><mrow 
><mo 
class="MathClass-bin">âˆ—</mo></mrow></msup 
></mrow></msub 
></math>,
<!--l. 393--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
></math> minimizes the J-S
divergence between <!--l. 394--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>
and <!--l. 394--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>.
</p><!--l. 396--><p class="indent" >   In WGAN, <!--l. 396--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
></math> maximizes the
Wasserstein distance between <!--l. 396--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>áº‹</mi></math>
and <!--l. 397--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>x</mi></mrow><mo accent="true">~</mo></mover></math> while
<!--l. 397--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
></math> tries to
reduce it. Wasserstein distance is a smoother and more eï¬€ective measure of closeness between two distributions, resulting in more stable training and
less mode collapse in WGAN than GAN.
</p><!--l. 402--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">4   </span> <a 
 id="x1-120004"></a>Latent Representation and BiGAN</h3>
<!--l. 404--><p class="noindent" >The training of Variational Autoencoders produces both a generator and a encoder. The latter is capable of extracting features or latent representations of data. GAN only has a generator
<!--l. 406--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
></math>. It is conceivable that the pre-ï¬nal layers
of the discriminator <!--l. 407--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
></math> may be used for feature
representations. The intuition is that <!--l. 408--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
></math>
would have learned useful high-level representations of both real and artiï¬cial samples.
</p><!--l. 412--><p class="indent" >   Bidirectional Generative Adversarial Networks (BiGAN), depicted in Figure <a 
href="#x1-120014">4<!--tex4ht:ref: fig:BiGAN-architecture --></a>, takes a much more direct approach to latent representation. It introduces an
encoder <!--l. 414--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>Î³</mi></mrow></msub 
></math> that maps
real samples <!--l. 415--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>áº‹</mi></math> to
<!--l. 415--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>z</mi></mrow><mo accent="true">~</mo></mover></math> in the latent space.
<!--l. 416--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>Ï•</mi></mrow></msub 
></math> works on the joint distribution
of <!--l. 416--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></math> and tries to maximize the
contrast between real samples <!--l. 417--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">(</mo><mi 
>áº‹</mi><mo 
class="MathClass-punc">,</mo><mover 
accent="true"><mrow 
><mi 
>z</mi></mrow><mo accent="true">~</mo></mover><mo 
class="MathClass-close">)</mo></math>
and artiï¬cial samples <!--l. 418--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">(</mo><mover 
accent="true"><mrow 
><mi 
>x</mi></mrow><mo accent="true">~</mo></mover><mo 
class="MathClass-punc">,</mo><mi 
>z</mi><mo 
class="MathClass-close">)</mo></math>.
The loss function introduced in WGAN-GP can be used here. After training is done, new samples can be generated by
<!--l. 420--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>ğœƒ</mi></mrow></msub 
></math>, and latent representations
can be inferred via <!--l. 421--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>Î³</mi></mrow></msub 
></math>.
</p><figure class="figure"> 

<a 
 id="x1-120014"></a>
<!--l. 424--><p class="noindent" ><img 
src="pyx_bigan.svg" alt="PIC"  
 /><br />
</p>
<figcaption class="caption" ><span class="id">FigureÂ 4:</span><span  
class="content">BiGAN architecture</span></figcaption><!--tex4ht:label?: x1-120014 -->
   </figure>
   <h3 class="sectionHead"><span class="titlemark">5   </span> <a 
 id="x1-130005"></a>Image-to-image translation and CycleGAN</h3>
<!--l. 433--><p class="noindent" >A GANâ€™s generator maps samples drawn from <!--l. 433--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>N</mi><mo 
class="MathClass-open">(</mo><mn>0</mn><mo 
class="MathClass-punc">,</mo><mi 
>I</mi><mo 
class="MathClass-close">)</mo></math>
to meaningful images. Can GAN map images in one domain to ones in another domain, for example from summer pictures to winter pictures of the
same place, from horse pictures to zebra pictures, and from photos to Van Goghâ€™s paintings?
</p><!--l. 439--><p class="indent" >   It is not hard to design a GAN for that purpose. For example, suppose our goal is to add black/white stripes to a horse and make it look like a zebra,
we could replace <!--l. 441--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>z</mi> <mo 
class="MathClass-rel">âˆ¼</mo> <mi 
>N</mi><mo 
class="MathClass-open">(</mo><mn>0</mn><mo 
class="MathClass-punc">,</mo><mi 
>I</mi><mo 
class="MathClass-close">)</mo></math>
with a bunch of horse pictures, and the real samples will be drawn from zebra pictures. Unfortunately, this architecture does not ensure
that the generated zebra picture will be much like the input horse picture. CycleGAN introduced two innovations to address this
problem:
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-13002x1">Create two GANs. The ï¬rst GAN translates horse pictures to zebra pictures, and the second GAN translates zebra pictures to horse
     pictures.
     </li>
     <li 
  class="enumerate" id="x1-13004x2">Each generated zebra picture is then fed to the second GAN to translate to a horse picture. This generated horse picture should look
     similar to the original horse picture. A similar process happens with the reverse translation direction.</li></ol>
<!--l. 454--><p class="noindent" >For simplicity, weâ€™ll use the following notation. <br 
class="newline" />
</p>
   <div class="tabular"> <table id="TBL-6" class="tabular" 
rules="groups" 
><colgroup id="TBL-6-1g"><col 
id="TBL-6-1" /></colgroup><colgroup id="TBL-6-2g"><col 
id="TBL-6-2" /></colgroup><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-6-1-"><td  style="text-align:center; white-space:nowrap;" id="TBL-6-1-1"  
class="td11">                                                     Notation                                                                                    </td><td  style="text-align:center; white-space:nowrap;" id="TBL-6-1-2"  
class="td11">                                                                                                                                   Meaning                                                                                                                                                                                                              </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-6-2-"><td  style="text-align:center; white-space:nowrap;" id="TBL-6-2-1"  
class="td11"><!--l. 461--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math></td><td  style="text-align:center; white-space:nowrap;" id="TBL-6-2-2"  
class="td11">                                                                  real samples from domain <!--l. 461--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>X</mi></math>                                                                                        </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-6-3-"><td  style="text-align:center; white-space:nowrap;" id="TBL-6-3-1"  
class="td11"><!--l. 463--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>y</mi></math></td><td  style="text-align:center; white-space:nowrap;" id="TBL-6-3-2"  
class="td11">                                                                  real samples from domain <!--l. 463--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Y</mi> </math>                                                                                        </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-6-4-"><td  style="text-align:center; white-space:nowrap;" id="TBL-6-4-1"  
class="td11"><!--l. 465--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>x</mi></mrow></msub 
></math></td><td  style="text-align:center; white-space:nowrap;" id="TBL-6-4-2"  
class="td11">                                                                 descriminator for samples in <!--l. 465--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>X</mi></math>                                                                                       </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-6-5-"><td  style="text-align:center; white-space:nowrap;" id="TBL-6-5-1"  
class="td11"><!--l. 467--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>y</mi></mrow></msub 
></math></td><td  style="text-align:center; white-space:nowrap;" id="TBL-6-5-2"  
class="td11">                                                                 descriminator for samples in <!--l. 467--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Y</mi> </math>                                                                                       </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-6-6-"><td  style="text-align:center; white-space:nowrap;" id="TBL-6-6-1"  
class="td11"><!--l. 469--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>x</mi><mi 
>y</mi></mrow></msub 
></math></td><td  style="text-align:center; white-space:nowrap;" id="TBL-6-6-2"  
class="td11">generator that maps samples in <!--l. 469--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>X</mi></math> to samples in <!--l. 469--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Y</mi> </math></td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-6-7-"><td  style="text-align:center; white-space:nowrap;" id="TBL-6-7-1"  
class="td11"><!--l. 471--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>y</mi><mi 
>x</mi></mrow></msub 
></math></td><td  style="text-align:center; white-space:nowrap;" id="TBL-6-7-2"  
class="td11">generator that maps samples in <!--l. 471--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Y</mi> </math> to samples in <!--l. 471--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>X</mi></math></td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-6-8-"><td  style="text-align:center; white-space:nowrap;" id="TBL-6-8-1"  
class="td11"><!--l. 473--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>G</mi><mi 
>A</mi><mi 
>N</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>X</mi><mo 
class="MathClass-punc">,</mo><mi 
>Y</mi><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>x</mi><mi 
>y</mi></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>y</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo></math></td><td  style="text-align:center; white-space:nowrap;" id="TBL-6-8-2"  
class="td11">   GANâ€™s loss function that involves <!--l. 473--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>x</mi><mi 
>y</mi></mrow></msub 
></math> and <!--l. 473--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>y</mi></mrow></msub 
></math>     </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-6-9-"><td  style="text-align:center; white-space:nowrap;" id="TBL-6-9-1"  
class="td11"><!--l. 475--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>G</mi><mi 
>A</mi><mi 
>N</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>Y</mi><mo 
class="MathClass-punc">,</mo><mi 
>X</mi><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>y</mi><mi 
>x</mi></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>x</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo></math></td><td  style="text-align:center; white-space:nowrap;" id="TBL-6-9-2"  
class="td11">   GANâ€™s loss function that involves <!--l. 475--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>y</mi><mi 
>x</mi></mrow></msub 
></math> and <!--l. 475--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>x</mi></mrow></msub 
></math>     </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-6-10-"><td  style="text-align:center; white-space:nowrap;" id="TBL-6-10-1"  
class="td11">                                                                                                                   </td> </tr></table>
</div><br 
class="newline" />
<!--l. 479--><p class="indent" >   CycleGANâ€™s optimization objective is </p><table class="equation-star"><tr><td>
<!--l. 480--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                 <msub><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>G</mi><mi 
>A</mi><mi 
>N</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>X</mi><mo 
class="MathClass-punc">,</mo><mi 
>Y</mi><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>x</mi><mi 
>y</mi></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>y</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>G</mi><mi 
>A</mi><mi 
>N</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>Y</mi><mo 
class="MathClass-punc">,</mo><mi 
>X</mi><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>y</mi><mi 
>x</mi></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>x</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <mi 
>Î»</mi><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi></mrow></msub 
><msub><mrow 
> <mrow><mo fence="true" form="prefix"> âˆ¥</mo><mrow><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>y</mi><mi 
>x</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>x</mi><mi 
>y</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">âˆ’</mo> <mi 
>x</mi></mrow><mo fence="true" form="postfix">âˆ¥</mo></mrow></mrow><mrow 
><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <mi 
>Î»</mi><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>y</mi></mrow></msub 
><msub><mrow 
> <mrow><mo fence="true" form="prefix"> âˆ¥</mo><mrow><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>x</mi><mi 
>y</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>y</mi><mi 
>x</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">âˆ’</mo> <mi 
>y</mi></mrow><mo fence="true" form="postfix">âˆ¥</mo></mrow></mrow><mrow 
><mn>1</mn></mrow></msub 
>
</math></td></tr></table>
    
</body> 
</html>


